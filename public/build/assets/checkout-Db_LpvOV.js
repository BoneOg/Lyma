import{J as v,r as l,u as _,j as e,S as C}from"./app-XNqQsOhP.js";import{L as k}from"./layout-wmb3PU5B.js";const r=t=>{if(!t)return"";const i=t.toUpperCase();if(i.includes("AM")||i.includes("PM"))return t;const s=t.split(":");if(s.length<2)return t;let n=parseInt(s[0],10);const o=s[1],f=n>=12?"PM":"AM";return n=n%12,n===0&&(n=12),`${n}:${o.padStart(2,"0")} ${f}`},S=t=>new Date(t).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});function L(){const{reservation:t,expiresAt:i,specialHoursData:s}=v().props,[n,o]=l.useState(!1),[f,c]=l.useState(null),{showNotification:$}=_(),[d,R]=l.useState(!1),[h,m]=l.useState(!1),p=a=>new Date(a).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),g=async()=>{m(!0)},j=async()=>{var u;const a=`${t.guest_first_name} ${t.guest_last_name}`.trim(),x=S(t.reservation_date),N=s?`${r(s.special_start)} - ${r(s.special_end)} (Special Hours)`:t.time_slot?`${r(t.time_slot.start_time)} - ${r(t.time_slot.end_time)}`:"Time not specified",w={to:t.guest_email,guest_name:a,phone:t.guest_phone||"",date_formatted:x,time_range:N,guest_count:t.guest_count};await fetch("/api/send-reservation-confirmation",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.content)||""},body:JSON.stringify(w)})},b=async()=>{m(!1),o(!0),c(null);try{C.post(`/checkout/${t.id}/confirm`,{},{onSuccess:async()=>{try{await j()}catch(a){console.warn("Email send failed (non-blocking):",a)}},onError:a=>{c(a.message||"Failed to confirm reservation. Please try again."),o(!1)},onFinish:()=>{o(!1)}})}catch(a){console.error("Error confirming reservation:",a),c("An unexpected error occurred. Please check your internet connection."),o(!1)}},y=()=>{m(!1)};return e.jsxs(k,{children:[e.jsx("div",{className:"min-h-screen bg-[#f6f5c6] flex items-center justify-center py-12 px-4",children:e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h1",{className:"text-3xl font-lexend font-medium text-[#3f411a] mb-6 text-center",children:"Confirm Your Reservation"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Guest Name"}),e.jsxs("span",{className:"text-[#3f411a] font-lexend font-medium",children:[t.guest_first_name," ",t.guest_last_name]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Email"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:t.guest_email})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Phone"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:t.guest_phone})]}),t.special_requests&&e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Special Requests"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium max-w-xs text-right",children:t.special_requests})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Date"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:p(t.reservation_date)})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Year"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:new Date(t.reservation_date).getFullYear()})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Time"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:s?`${r(s.special_start)} - ${r(s.special_end)} (Special Hours)`:t.time_slot?`${r(t.time_slot.start_time)} - ${r(t.time_slot.end_time)}`:"Time not specified"})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Number of Guests"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:t.guest_count})]})]}),e.jsx("button",{onClick:g,disabled:n||d,className:`w-full py-4 font-lexend font-medium text-lg transition-all duration-200 ${n||d?"bg-[#3f411a]/30 text-[#3f411a]/50 cursor-not-allowed":"bg-[#3f411a] text-white hover:bg-[#2a2d12] active:scale-[0.98]"}`,children:d?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-[#3f411a]/50",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Reservation is about to expire. Try booking again soon."]}):n?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Confirming Reservation..."]}):"Confirm Reservation"})]})})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-lexend font-medium text-[#3f411a] mb-2",children:"Confirm Reservation"}),e.jsx("p",{className:"text-[#3f411a]/80 font-lexend font-light mb-6",children:"Is this information correct?"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:y,className:"flex-1 py-2 px-4 bg-gray-200 text-gray-700 rounded-lg font-lexend font-medium hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:b,className:"flex-1 py-2 px-4 bg-[#3f411a] text-white rounded-lg font-lexend font-medium hover:bg-[#2a2d12] transition-colors",children:"Confirm"})]})]})})})]})}export{L as default};
