import{J as ge,r as n,j as e,t as fe,S as De,u as pe,R as $e}from"./app-D49Axx_r.js";import{S as ae,a as ne,b as re,c as oe,d as te,C as Me}from"./Calendar-Mx0UFi8a.js";import{n as Ee,c as me}from"./utils-BysOelSn.js";import{S as Le,D as Te,a as Re,s as Oe,T as Fe,R as Ie}from"./reservationTable-_L-QLa6Z.js";import{P as Ae}from"./x-BcArN6OG.js";import"./index-B01Zkh07.js";import"./createLucideIcon-CqKl-vcJ.js";import"./check-CO6dDy9p.js";import"./proxy-cEygHGGA.js";const Ye=()=>{const{url:N}=ge(),[b,f]=n.useState(!1),d=()=>{f(!0)},v=()=>{De.post("/logout")},C=()=>{f(!1)},m=[{id:"booking",label:"Booking",href:"/staff/booking"}],u=(N.startsWith("/staff/booking"),"booking");return e.jsxs("div",{className:"fixed top-0 left-0 h-screen w-64 bg-olive text-white flex flex-col shadow-xl z-20 border-r border-olive-light",children:[e.jsx("div",{className:"p-6 border-b border-olive-light",children:e.jsx(fe,{href:"/staff/booking",className:"block overflow-hidden",children:e.jsx("img",{src:"/assets/logo/lymabeige.webp",alt:"Lyma by Chef Mar",className:"w-full h-16 object-contain object-center",style:{objectPosition:"center",objectFit:"contain",transform:"scale(1)",transformOrigin:"center"}})})}),e.jsx("nav",{className:"flex-1 pb-6",children:m.map(x=>e.jsxs(fe,{href:x.href,className:`w-full flex items-center px-6 py-5 text-left font-lexend font-extralight transition-all duration-200 ease-in-out ${u===x.id?"bg-[#5a5d2a] text-[#f6f5c6]":"text-[#e8e6b3] hover:bg-[#5a5d2a] hover:text-[#f6f5c6]"}`,children:[e.jsx("span",{className:"mr-3 transition-transform duration-200 ease-in-out group-hover:scale-110",children:x.id==="booking"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5",children:[e.jsx("path",{d:"M2 12c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12v2c0 3.771 0 5.657-1.172 6.828S17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.212S2 17.771 2 14z"}),e.jsx("path",{"stroke-linecap":"round",d:"M7 4V2.5M17 4V2.5M2.5 9h19"})]})})}),e.jsx("span",{className:"transition-all duration-200 ease-in-out font-lexend",children:x.label})]},x.id))}),e.jsx("div",{className:"border-t border-[#5a5d2a]",children:e.jsxs("button",{onClick:d,className:"relative flex items-center text-white hover:text-[#f6f5c6] hover:bg-[#5a5d2a] justify-center transition-all duration-200 ease-in-out rounded w-full font-lexend py-5",children:[e.jsx("span",{className:"absolute left-6 transform -scale-x-100 transition-transform duration-200 ease-in-out hover:scale-110",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M13.496 21H6.5c-1.105 0-2-1.151-2-2.571V5.57c0-1.419.895-2.57 2-2.57h7M16 15.5l3.5-3.5L16 8.5m-6.5 3.496h10"})})}),e.jsx("span",{className:"transition-all duration-200 ease-in-out font-lexend font-extralight",children:"Logout"})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background text-olive rounded p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-lexend font-semibold tracking-tighter",children:"Confirm Logout"}),e.jsx("p",{className:"text-olive mb-6 font-lexend font-light tracking-tight",children:"Are you sure you want to logout?"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:C,className:"flex-1 bg-[hsl(var(--destructive))] hover:bg-[hsl(var(--destructive)/0.8)] text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"No"}),e.jsx("button",{onClick:v,className:"flex-1 bg-olive hover:bg-olive-light text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"Yes"})]})]})})]})},Pe=({children:N})=>e.jsxs("div",{className:"min-h-screen bg-beige-light relative",children:[e.jsx("div",{className:"fixed top-0 left-0 h-full z-10",children:e.jsx(Ye,{})}),e.jsx("div",{className:"ml-64",children:N})]}),Be=({isOpen:N,onClose:b,onDateSelect:f,selectedDate:d,onMonthSelect:v,selectedMonth:C,selectedYear:m})=>{const[y,u]=n.useState(()=>d?new Date(d).toLocaleString("default",{month:"long"}):new Date().toLocaleString("default",{month:"long"})),[x,r]=n.useState(()=>d?new Date(d).getFullYear():new Date().getFullYear()),[_,j]=n.useState(!1),[M,g]=n.useState(x),[W,L]=n.useState(!1),[Q,T]=n.useState(!1),k=["January","February","March","April","May","June","July","August","September","October","November","December"],D=(c,p)=>{const S=k.indexOf(c);return new Date(p,S+1,0).getDate()},H=(c,p)=>{const S=k.indexOf(c);return new Date(p,S,1).getDay()},A=c=>{const p=k.indexOf(y),S=new Date(x,p,c),w=S.getFullYear(),P=String(S.getMonth()+1).padStart(2,"0"),I=String(c).padStart(2,"0");return`${w}-${P}-${I}`},z=c=>{const p=A(c);console.log("Selected date:",p),f(p),b()},K=()=>{f(null),b()},F=()=>{const c=k.indexOf(y);c===0?(u("December"),r(x-1)):u(k[c-1])},h=()=>{const c=k.indexOf(y);c===11?(u("January"),r(x+1)):u(k[c+1])},R=()=>{v?v(y,x):f(null),b()},O=()=>{const c=D(y,x),p=H(y,x),S=[];for(let w=0;w<p;w++)S.push(e.jsx("div",{className:"h-8"},`empty-${w}`));for(let w=1;w<=c;w++){const P=A(w),I=d===P;S.push(e.jsx("div",{onClick:()=>z(w),className:`cursor-pointer transition-colors h-8 flex items-center justify-center rounded-lg font-lexend ${I?"bg-olive text-beige":"text-[#3f411a] hover:bg-olive hover:text-beige"}`,children:w},w))}return S},Y=new Date().getFullYear();return Array.from({length:6},(c,p)=>Y+p),N?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background rounded p-8 shadow-lg max-w-lg w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-[#3f411a] font-lexend",children:"Select Date"}),e.jsx("button",{onClick:b,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:F,className:"p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors","aria-label":"Previous Month",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"relative mx-2 flex-1 flex justify-center",children:[e.jsxs("button",{onClick:()=>{j(!_),g(x)},className:"px-4 py-2 text-lg font-semibold text-[#3f411a] font-lexend rounded hover:bg-gray-300 transition-colors text-center whitespace-nowrap",style:{minWidth:140},children:[y," ",x]}),_&&e.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-3 bg-background border border-gray-400 rounded-lg shadow-lg z-10 min-w-[380px] p-4",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("button",{onClick:()=>g(M-1),className:"absolute left-0 top-1/2 -translate-y-1/2 p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("span",{className:"block text-xl font-semibold text-[#3f411a] font-lexend select-none text-center",children:M}),e.jsx("button",{onClick:()=>g(M+1),className:"absolute right-0 top-1/2 -translate-y-1/2 p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-4",children:k.map(c=>e.jsx("button",{onClick:()=>{u(c),r(M),j(!1)},className:`flex items-center justify-center px-6 py-3 hover:bg-olive hover:text-beige cursor-pointer transition-colors rounded font-lexend text-olive text-sm ${c===y&&M===x?"bg-olive text-beige  font-medium":""}`,children:c},c))}),e.jsx("button",{onClick:()=>j(!1),className:"w-full mt-2 px-3 py-2 text-base text-olive font-lexend bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors cursor-pointer rounded",children:"Close"})]})]}),e.jsx("button",{onClick:h,className:"p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors","aria-label":"Next Month",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"grid grid-cols-7 text-center gap-y-2 mb-4",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map(c=>e.jsx("div",{className:"text-base font-medium text-gray-500 font-lexend",children:c},c)),O()]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:R,className:"w-full bg-olive-light hover:bg-olive text-beige py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Select This Month"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:K,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Clear Date"}),e.jsx("button",{onClick:b,className:"flex-1 bg-olive hover:bg-olive-dark text-beige py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Close"})]})]})}):null},He=({isOpen:N,onClose:b,onConfirm:f,action:d,reservationName:v})=>{const C=()=>d==="complete"?"Complete Reservation":"Cancel Reservation",m=()=>d==="complete"?e.jsxs(e.Fragment,{children:["Are you sure you want to ",e.jsx("span",{className:"font-bold text-green-700 ",children:"complete"})," the reservation for ",e.jsx("span",{className:"font-bold ",children:v}),"?"]}):e.jsxs(e.Fragment,{children:["Are you sure you want to ",e.jsx("span",{className:"font-bold text-red-700 ",children:"cancel"})," the reservation for ",e.jsx("span",{className:"font-bold",children:v}),"?"]});return N?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background text-olive rounded p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-lexend font-semibold tracking-tighter",children:C()}),e.jsx("p",{className:"text-olive mb-6 font-lexend font-light tracking-tight",children:m()}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:b,className:"flex-1 bg-[hsl(var(--destructive))] hover:bg-[hsl(var(--destructive)/0.8)] text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"No"}),e.jsx("button",{onClick:f,className:"flex-1 bg-olive hover:bg-olive-light text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"Yes"})]})]})}):null},ze=({isOpen:N,onClose:b,onReservationCreated:f,timeSlots:d,systemSettings:v})=>{const{showNotification:C}=pe(),[m,y]=n.useState(new Date().getMonth()),[u,x]=n.useState(new Date().getFullYear()),[r,_]=n.useState(d.length>0?d[0].id:null),[j,M]=n.useState(v.min_guest_size||1),[g,W]=n.useState(null),[L,Q]=n.useState(""),[T,k]=n.useState(""),[D,H]=n.useState(""),[A,z]=n.useState(""),[K,F]=n.useState(""),[h,R]=n.useState([]),[O,Y]=n.useState([]),[c,p]=n.useState([]),[S,w]=n.useState([]),[P,I]=n.useState({}),[U,X]=n.useState(!1),Z=["January","February","March","April","May","June","July","August","September","October","November","December"],le=[new Date().getFullYear(),new Date().getFullYear()+1,new Date().getFullYear()+2],ie=new Date,s=new Date(ie.getTime()+v.max_advance_booking_days*24*60*60*1e3);n.useEffect(()=>{i(),$(),V()},[m,u]);const i=async()=>{try{const a=await(await fetch(`/reservations/fully-booked-dates?month=${m+1}&year=${u}`)).json();p(a.fully_booked_dates||[])}catch(t){console.error("Error fetching fully booked dates:",t),p([])}},$=async()=>{try{const a=await(await fetch(`/reservations/closed-dates?month=${m+1}&year=${u}`)).json();w(a.closed_dates||[])}catch(t){console.error("Error fetching closed dates:",t),w([])}},V=async()=>{try{const a=await(await fetch(`/reservations/special-hours-dates?month=${m+1}&year=${u}`)).json(),o={};a.special_hours_data&&a.special_hours_data.forEach(l=>{o[l.day]={special_start:l.special_start,special_end:l.special_end}}),I(o)}catch(t){console.error("Error fetching special hours dates:",t),I({})}},ee=t=>{const a=new Date(u,m,t);a.setHours(0,0,0,0);const o=new Date;return o.setHours(0,0,0,0),!!(a<o||a>s||S.includes(t))},q=t=>c.includes(t),be=t=>S.includes(t),ue=t=>P.hasOwnProperty(t),ce=t=>P[t]||null,se=t=>{if(!t)return"";const a=t.toUpperCase();if(a.includes("AM")||a.includes("PM"))return t;const o=t.split(":");if(o.length<2)return t;let l=parseInt(o[0],10);const B=o[1],J=l>=12?"PM":"AM";return l=l%12,l===0&&(l=12),`${l}:${B.padStart(2,"0")} ${J}`},ve=t=>new Date(t).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),je=async t=>{var J;const a=ve(t.reservation_date);let o="Time not specified";if(g){const E=ce(g);if(E&&(r==="special-hours"||!t.time_slot_id))o=`${se(E.special_start)} - ${se(E.special_end)} (Special Hours)`;else if(t.time_slot_id){const G=d.find(ke=>ke.id===t.time_slot_id);G&&(o=G.start_time_formatted&&G.end_time_formatted?`${G.start_time_formatted} - ${G.end_time_formatted}`:`${se(G.start_time)} - ${se(G.end_time)}`)}}const l=`${t.guest_first_name} ${t.guest_last_name}`.trim(),B={to:t.guest_email,guest_name:l,phone:t.guest_phone||"",date_formatted:a,time_range:o,guest_count:t.guest_count};try{await fetch("/api/send-reservation-confirmation",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((J=document.querySelector('meta[name="csrf-token"]'))==null?void 0:J.getAttribute("content"))||""},body:JSON.stringify(B)})}catch{}},we=async t=>{try{const o=await(await fetch(`/reservations/occupied-time-slots?date=${t}`)).json();R(o.occupied_time_slots||[]),Y(o.disabled_time_slots||[])}catch(a){console.error("Error fetching occupied time slots:",a),R([]),Y([])}},Ne=t=>{W(t);const a=`${u}-${String(m+1).padStart(2,"0")}-${String(t).padStart(2,"0")}`;if(we(a),ue(t))_("special-hours");else{const o=d.find(l=>!h.includes(l.id)&&!O.includes(l.id));_((o==null?void 0:o.id)||null)}};n.useEffect(()=>{if(r&&typeof r=="number"&&(h.includes(r)||O.includes(r))){const t=d.find(a=>!h.includes(a.id)&&!O.includes(a.id));_((t==null?void 0:t.id)||null)}},[h,O,r,d]);const ye=()=>{const t=[];if(g){const o=new Date(u,m,g).toLocaleDateString("en-US",{weekday:"short"}),l=Z[m];t.push(`${l} ${g} (${o})`)}if(r)if(r==="special-hours"){const a=ce(g);a&&t.push(`${a.special_start} - ${a.special_end} (Special Hours)`)}else{const a=d.find(o=>o.id===r);a&&t.push(`${a.start_time_formatted} - ${a.end_time_formatted}`)}return t.push(`${j} Guest${j>1?"s":""}`),!g&&!r?"Select date and time":t.join(", ")},de=()=>g&&r&&(r==="special-hours"||!h.includes(r)&&!O.includes(r))&&L.trim()&&T.trim()&&D.trim()&&A.trim()&&D.includes("@")&&D.includes("."),he=(t,a)=>{/^[a-zA-Z\s]*$/.test(t)&&a(t)},Se=t=>{H(t)},Ce=t=>{/^[\d\s\-\+]*$/.test(t)&&t.length<=15&&z(t)},_e=async()=>{var t;if(de()){X(!0);try{const a={guest_first_name:L.trim(),guest_last_name:T.trim(),guest_email:D.trim(),guest_phone:A.trim(),special_requests:K.trim(),reservation_date:`${u}-${String(m+1).padStart(2,"0")}-${String(g).padStart(2,"0")}`,time_slot_id:r==="special-hours"?null:r,guest_count:j,is_special_hours:r==="special-hours"},l=await(await fetch("/staff/api/quick-reservations",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify(a)})).json();if(l.success){C("Reservation created successfully!","success");try{await je(l.reservation??a)}catch{}f&&f(),xe()}else C(l.message||"Failed to create reservation","error")}catch(a){console.error("Error creating reservation:",a),C("An error occurred while creating the reservation","error")}finally{X(!1)}}},xe=()=>{y(new Date().getMonth()),x(new Date().getFullYear()),_(d.length>0?d[0].id:null),M(v.min_guest_size||1),W(null),Q(""),k(""),H(""),z(""),F(""),R([]),Y([]),p([]),w([]),I({}),X(!1),b()};return N?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-[#3f411a] rounded shadow-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl text-beige font-lexend font-extralight",children:"QUICK RESERVATION"}),e.jsx("button",{onClick:xe,className:"text-white cursor-pointer text-3xl font-bold hover:text-beige transition-colors",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"flex flex-col justify-start h-full",children:e.jsxs("div",{className:"flex flex-col justify-start h-full",children:[e.jsxs("div",{className:"flex space-x-4 mb-10",children:[e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Month"}),e.jsxs(ae,{value:m.toString(),onValueChange:t=>{y(parseInt(t)),W(null)},children:[e.jsx(ne,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(re,{})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white max-h-none overflow-y-visible",children:Z.map((t,a)=>e.jsx(te,{value:a.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-28",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Year"}),e.jsxs(ae,{value:u.toString(),onValueChange:t=>x(parseInt(t)),children:[e.jsx(ne,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(re,{})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white",children:le.map(t=>e.jsx(te,{value:t.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Time"}),e.jsxs(ae,{value:(r==null?void 0:r.toString())||"",onValueChange:t=>{_(t==="special-hours"?"special-hours":parseInt(t))},children:[e.jsx(ne,{className:`bg-transparent border-b border-white text-white w-full font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto text-left ${r==="special-hours"?"py-3 text-xs":"py-2 text-base"}`,children:e.jsx(re,{children:(()=>{if(r==="special-hours")return"Special Hours";if(r&&typeof r=="number"){const t=d.find(a=>a.id===r);return t?`${t.start_time_formatted} - ${t.end_time_formatted}`:""}return""})()})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white",children:(()=>{const t=g?ce(g):null;return t?e.jsxs(te,{value:"special-hours",className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:[t.special_start," - ",t.special_end," (Special Hours)"]}):d.map(a=>{const o=h.includes(a.id),l=O.includes(a.id),B=o||l;return e.jsxs(te,{value:a.id.toString(),className:`bg-[#3f411a] font-extralight font-lexend focus:bg-[#5a5d2a] relative ${B?"cursor-not-allowed":"hover:bg-[#5a5d2a]"} ${o?"!opacity-100":""} ${l?"!opacity-100":""}`,disabled:B,children:[e.jsxs("span",{className:o?"text-[#D4847C]":l?"text-[#5295bb]":"text-white",children:[a.start_time_formatted," - ",a.end_time_formatted]}),o&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-[#D4847C] rounded-full opacity-100"}),l&&!o&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-[#5295bb] rounded-full opacity-100"})]},a.id)})})()})]})]}),e.jsxs("div",{className:"relative w-24",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Guests"}),e.jsxs(ae,{value:j.toString(),onValueChange:t=>M(parseInt(t)),children:[e.jsx(ne,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(re,{children:j})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white",children:(()=>{const t=v.min_guest_size||1,a=v.max_guest_size||10,o=[];for(let l=t;l<=a;l++)o.push(l);return o.map(l=>e.jsx(te,{value:l.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:l},l))})()})]})]})]}),e.jsx(Me,{selectedMonth:m,selectedYear:u,selectedDate:g,onDateSelect:Ne,isDateDisabled:ee,isDateFullyBooked:q,isDateClosed:be,isDateSpecialHours:ue,months:Z,className:"grid grid-cols-7 text-center gap-y-7 text-white text-lg",weekdayClassName:()=>"h-8 flex items-center justify-center font-lexend text-beige font-medium tracking-wide opacity-80",dayClassName:(t,{isDisabled:a,isFullyBooked:o,isSelected:l,isClosed:B,isSpecialHours:J})=>{let E="transition-colors h-8 w-full flex items-center justify-center font-lexend font-light relative";return B?E+=" text-[#D4847C] cursor-not-allowed":o?E+=" text-[#6B7A5E] cursor-not-allowed":l&&J?E+=" text-[#C5A572] font-semibold":l?E+=" text-[#3f411a] font-semibold":J?E+=" text-[#C5A572] hover:text-beige-dark cursor-pointer":a?E+=" text-gray-400 cursor-not-allowed":E+=" text-white hover:text-beige-dark cursor-pointer",E},animatedSelection:!0}),e.jsxs("div",{className:"flex justify-center items-center space-x-6 mt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#6B7A5E]"}),e.jsx("span",{className:"text-white/80 font-light font-lexend text-sm",children:"Fully Booked"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#C5A572]"}),e.jsx("span",{className:"text-white/80 font-light font-lexend text-sm",children:"Special Hours"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#D4847C]"}),e.jsx("span",{className:"text-white/80 font-light font-lexend text-sm",children:"Closed"})]})]})]})}),e.jsxs("div",{className:"flex flex-col justify-between h-full self-stretch w-full max-w-md ml-auto",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-3 text-white",children:"When"}),e.jsx("div",{className:"border-b border-white pb-2 text-lg font-extralight font-lexend text-white",children:ye()})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"First Name"}),e.jsx("input",{type:"text",value:L,onChange:t=>he(t.target.value,Q),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"First name",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Last Name"}),e.jsx("input",{type:"text",value:T,onChange:t=>he(t.target.value,k),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"Last name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Email"}),e.jsx("input",{type:"email",value:D,onChange:t=>Se(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Phone Number"}),e.jsx("input",{type:"tel",value:A,onChange:t=>Ce(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"+639543846071",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Special Requests"}),e.jsx("input",{type:"text",value:K,onChange:t=>F(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"ex. Food Allergies"})]})]})]}),e.jsx("button",{onClick:_e,disabled:!de()||U,className:`block w-full text-center font-light font-lexend py-4 mt-8 text-lg transition duration-200 uppercase ${de()&&!U?"bg-beige-dark active:bg-beige text-[#3f411a] hover:opacity-90 hover:scale-[1.02] active:scale-[0.98] hover:shadow-lg cursor-pointer tracking-wider":"bg-gray-400 text-gray-600 cursor-not-allowed tracking-wider"}`,children:U?"CREATING RESERVATION...":"CREATE RESERVATION"})]})]})]})})}):null},Ve=({status:N,onReservationUpdate:b,endpointPrefix:f,timeSlots:d,systemSettings:v})=>{const{showNotification:C}=pe(),[m,y]=n.useState([]),[u,x]=n.useState(null),[r,_]=n.useState(!1),[j,M]=n.useState(""),[g,W]=n.useState("date-asc"),[L,Q]=n.useState(()=>new Date().toISOString().split("T")[0]),[T,k]=n.useState(null),[D,H]=n.useState(null),[A,z]=n.useState(!1),[K,F]=n.useState(!1),[h,R]=n.useState(null),[O,Y]=n.useState(!1);n.useEffect(()=>{_(!0),fetch(`${f||"/staff"}/api/reservations?status=${N}`).then(s=>s.json()).then(s=>{let i=s.reservations||[];N==="all"&&(i=i.filter($=>$.status!=="pending")),y(i),_(!1)})},[N,f]);const c=n.useCallback(s=>{x(u===s?null:s)},[u]),p=n.useMemo(()=>m.filter(s=>{const i=s.guest_first_name.toLowerCase().includes(j.toLowerCase())||s.guest_last_name.toLowerCase().includes(j.toLowerCase())||s.email.toLowerCase().includes(j.toLowerCase())||s.phone.toLowerCase().includes(j.toLowerCase());let $=!0;if(L)$=Ee(s.reservation_date)===L;else if(T&&D){const V=new Date(s.reservation_date),ee=V.toLocaleString("default",{month:"long"}),q=V.getFullYear();$=ee===T&&q===D}return i&&$}),[m,j,L,T,D]),S=n.useMemo(()=>[...p].sort((s,i)=>{switch(g){case"firstName-asc":return s.guest_first_name.localeCompare(i.guest_first_name);case"firstName-desc":return i.guest_first_name.localeCompare(s.guest_first_name);case"lastName-asc":return s.guest_last_name.localeCompare(i.guest_last_name);case"lastName-desc":return i.guest_last_name.localeCompare(s.guest_last_name);case"timeSlot-am-pm":return me(s.time_slot||"",i.time_slot||"");case"timeSlot-pm-am":return me(i.time_slot||"",s.time_slot||"");case"guest-asc":return s.guest_count-i.guest_count;case"guest-desc":return i.guest_count-s.guest_count;case"date-asc":return s.reservation_date.localeCompare(i.reservation_date);case"date-desc":return i.reservation_date.localeCompare(s.reservation_date);default:return 0}}),[p,g]),w=n.useCallback((s,i,$)=>{R({type:"complete",reservationId:s,reservationName:`${i} ${$}`}),F(!0)},[]),P=n.useCallback((s,i,$)=>{R({type:"cancel",reservationId:s,reservationName:`${i} ${$}`}),F(!0)},[]),I=n.useCallback(async()=>{var s;if(h)try{const i=h.type==="complete"?`${f||"/staff"}/api/reservations/${h.reservationId}/complete`:`${f||"/staff"}/api/reservations/${h.reservationId}/cancel`,V=await(await fetch(i,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}})).json();V.success?(y(ee=>ee.map(q=>q.id===h.reservationId?{...q,status:h.type==="complete"?"completed":"cancelled"}:q)),C(`Reservation ${h.type==="complete"?"completed":"cancelled"} successfully!`,"success"),b&&b()):C(`Failed to ${h.type} reservation: ${V.message}`,"error")}catch{C(`Failed to ${h.type} reservation. Please try again.`,"error")}finally{F(!1),R(null)}},[h,f,b,C]),U=n.useCallback(()=>{F(!1),R(null)},[]),X=n.useCallback(s=>{Q(s),k(null),H(null)},[]),Z=n.useCallback((s,i)=>{k(s),H(i),Q(null)},[]),le=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ie=()=>L?le(L):T&&D?`${T} ${D}`:"Date";return e.jsxs("div",{className:"bg-white border border-primary-light h-[520px] shadow p-6 flex flex-col",children:[e.jsxs("div",{className:"flex gap-4 mb-2",children:[e.jsx(Le,{value:j,onChange:s=>M(s.target.value),placeholder:"Search by guest name, email, or number...",className:"basis-[35%]"}),e.jsx(Te,{onClick:()=>z(!0),label:ie(),className:"basis-[15%]"}),e.jsx(Re,{value:g,onChange:W,options:Oe,className:"basis-[30%]"}),e.jsxs("button",{onClick:()=>Y(!0),className:"basis-[20%] flex items-center justify-center gap-3 h-10 border-primary-light border bg-primary-light text-olive font-lexend font-light px-2 py-1 transition-all duration-300 hover:scale-[1.02] focus:ring-1 focus:ring-olive focus:outline-none",children:[e.jsx(Ae,{size:18})," New Reservation"]})]}),r?e.jsx("div",{className:"text-center py-8 font-lexend font-light text-gray-500",children:"Loading..."}):S.length===0?e.jsx("div",{className:"text-center py-8 font-lexend text-gray-500",children:"No reservations found."}):e.jsx("div",{className:"w-full flex-1 min-h-0 overflow-y-auto",children:e.jsx(Fe,{children:e.jsxs("table",{className:"w-full text-left font-lexend table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"170px"}}),e.jsx("col",{style:{width:"90px"}}),e.jsx("col",{style:{width:"105px"}}),e.jsx("col",{style:{width:"80px"}}),e.jsx("col",{style:{width:"70px"}}),e.jsx("col",{style:{width:"95px"}}),e.jsx("col",{style:{width:"95px"}})]}),e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-white sticky top-0 z-0",children:[e.jsx("th",{className:"py-3 px-5 font-semibold tracking-tighter truncate",children:"First Name"}),e.jsx("th",{className:"py-3 px-2 font-semibold tracking-tighter truncate",children:"Last Name"}),e.jsx("th",{className:"py-3 px-2 font-semibold tracking-tighter truncate text-center",children:"Reservation Date"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Time Slot"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Guests"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Status"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Actions"})]})}),e.jsx("tbody",{children:S.map(s=>e.jsx(Ie,{reservation:s,expanded:u===s.id,onExpand:()=>c(s.id),onComplete:()=>w(s.id,s.guest_first_name,s.guest_last_name),onCancel:()=>P(s.id,s.guest_first_name,s.guest_last_name)},s.id))})]})})}),e.jsx(Be,{isOpen:A,onClose:()=>z(!1),onDateSelect:X,onMonthSelect:Z,selectedDate:L,selectedMonth:T,selectedYear:D}),e.jsx(He,{isOpen:K,onClose:U,onConfirm:I,action:(h==null?void 0:h.type)||"complete",reservationName:(h==null?void 0:h.reservationName)||""}),d&&v&&e.jsx(ze,{isOpen:O,onClose:()=>Y(!1),onReservationCreated:()=>{_(!0),fetch(`${f||"/staff"}/api/reservations?status=${N}`).then(s=>s.json()).then(s=>{let i=s.reservations||[];N==="all"&&(i=i.filter($=>$.status!=="pending")),y(i),_(!1)}),b&&b()},timeSlots:d,systemSettings:v})]})},qe=[{label:`CONFIRMED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"confirmed"},{label:`COMPLETED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"completed"},{label:`CANCELLED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"cancelled"},{label:`ALL
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"all"}],tt=()=>{const{timeSlots:N,systemSettings:b}=ge().props,[f,d]=n.useState({confirmed:0,completed:0,cancelled:0,all:0}),[v,C]=n.useState("all"),[m,y]=n.useState(!1),u=()=>{fetch("/staff/api/reservation-counts").then(r=>r.json()).then(r=>{d({confirmed:r.confirmed||0,completed:r.completed||0,cancelled:r.cancelled||0,all:r.all||0})}).catch(r=>{console.error("Error fetching counts:",r)})};n.useEffect(()=>{u()},[]);const x=()=>{u()};return e.jsxs(Pe,{children:[e.jsxs("div",{className:"flex flex-col items-center px-12 py-10",children:[e.jsx("p",{className:"text-olive text-7xl font-thin font-lexend text-center",children:"BOOKING"}),e.jsx("div",{className:"w-50 h-[1px] bg-olive mt-6",style:{opacity:.5}})]}),e.jsx("div",{className:"px-12 flex gap-6 mb-8",children:qe.map((r,_)=>e.jsx("button",{className:`flex-1 border-2 p-8 font-lexend font-light text-xl transition-all duration-300 cursor-pointer shadow-card hover:scale-[1.03] ${v===r.status?r.activeColor:r.color}`,onClick:()=>C(r.status),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("span",{children:r.label.split(`
`).map((j,M)=>e.jsxs($e.Fragment,{children:[j,e.jsx("br",{})]},M))}),e.jsx("span",{className:"mt-4 text-4xl font-bold tracking-wide",children:f[r.status]})]})},r.label))}),e.jsxs("div",{className:"px-12",children:[e.jsx("div",{className:"mb-6"}),e.jsx(Ve,{status:v,onReservationUpdate:x,endpointPrefix:"/staff",timeSlots:N,systemSettings:b})]})]})};export{tt as default};
