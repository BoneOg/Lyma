import{r as n,j as e,u as fe,J as Ce,R as ke}from"./app-JqLwcfHk.js";import{A as De}from"./AdminLayout-C-TdYsF9.js";import{S as ae,a as ne,b as re,c as oe,d as te,C as $e}from"./Calendar-Blg5kTFf.js";import{n as Me,c as me}from"./utils-BysOelSn.js";import{S as Ee,D as Te,a as Re,s as Le,T as Oe,R as Ie}from"./reservationTable-gmpLUYSP.js";import{P as Fe}from"./x-AY31D_w5.js";import"./index-JvhsksCB.js";import"./createLucideIcon-DuXOY6D4.js";import"./check-2-4uo4v2.js";import"./proxy-C8GA4D1z.js";const Ae=({isOpen:D,onClose:p,onDateSelect:b,selectedDate:h,onMonthSelect:j,selectedMonth:$,selectedYear:f})=>{const[v,r]=n.useState(()=>h?new Date(h).toLocaleString("default",{month:"long"}):new Date().toLocaleString("default",{month:"long"})),[y,i]=n.useState(()=>h?new Date(h).getFullYear():new Date().getFullYear()),[w,N]=n.useState(!1),[R,x]=n.useState(y),[W,E]=n.useState(!1),[K,T]=n.useState(!1),_=["January","February","March","April","May","June","July","August","September","October","November","December"],C=(u,m)=>{const S=_.indexOf(u);return new Date(m,S+1,0).getDate()},P=(u,m)=>{const S=_.indexOf(u);return new Date(m,S,1).getDay()},A=u=>{const m=_.indexOf(v),S=new Date(y,m,u),g=S.getFullYear(),H=String(S.getMonth()+1).padStart(2,"0"),F=String(u).padStart(2,"0");return`${g}-${H}-${F}`},V=u=>{const m=A(u);console.log("Selected date:",m),b(m),p()},Q=()=>{b(null),p()},I=()=>{const u=_.indexOf(v);u===0?(r("December"),i(y-1)):r(_[u-1])},c=()=>{const u=_.indexOf(v);u===11?(r("January"),i(y+1)):r(_[u+1])},L=()=>{j?j(v,y):b(null),p()},O=()=>{const u=C(v,y),m=P(v,y),S=[];for(let g=0;g<m;g++)S.push(e.jsx("div",{className:"h-8"},`empty-${g}`));for(let g=1;g<=u;g++){const H=A(g),F=h===H;S.push(e.jsx("div",{onClick:()=>V(g),className:`cursor-pointer transition-colors h-8 flex items-center justify-center rounded-lg font-lexend ${F?"bg-olive text-beige":"text-[#3f411a] hover:bg-olive hover:text-beige"}`,children:g},g))}return S},Y=new Date().getFullYear();return Array.from({length:6},(u,m)=>Y+m),D?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background rounded p-8 shadow-lg max-w-lg w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-[#3f411a] font-lexend",children:"Select Date"}),e.jsx("button",{onClick:p,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"Ã—"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:I,className:"p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors","aria-label":"Previous Month",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"relative mx-2 flex-1 flex justify-center",children:[e.jsxs("button",{onClick:()=>{N(!w),x(y)},className:"px-4 py-2 text-lg font-semibold text-[#3f411a] font-lexend rounded hover:bg-gray-300 transition-colors text-center whitespace-nowrap",style:{minWidth:140},children:[v," ",y]}),w&&e.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-3 bg-background border border-gray-400 rounded-lg shadow-lg z-10 min-w-[380px] p-4",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("button",{onClick:()=>x(R-1),className:"absolute left-0 top-1/2 -translate-y-1/2 p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("span",{className:"block text-xl font-semibold text-[#3f411a] font-lexend select-none text-center",children:R}),e.jsx("button",{onClick:()=>x(R+1),className:"absolute right-0 top-1/2 -translate-y-1/2 p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-4",children:_.map(u=>e.jsx("button",{onClick:()=>{r(u),i(R),N(!1)},className:`flex items-center justify-center px-6 py-3 hover:bg-olive hover:text-beige cursor-pointer transition-colors rounded font-lexend text-olive text-sm ${u===v&&R===y?"bg-olive text-beige  font-medium":""}`,children:u},u))}),e.jsx("button",{onClick:()=>N(!1),className:"w-full mt-2 px-3 py-2 text-base text-olive font-lexend bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors cursor-pointer rounded",children:"Close"})]})]}),e.jsx("button",{onClick:c,className:"p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors","aria-label":"Next Month",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"grid grid-cols-7 text-center gap-y-2 mb-4",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map(u=>e.jsx("div",{className:"text-base font-medium text-gray-500 font-lexend",children:u},u)),O()]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:L,className:"w-full bg-olive-light hover:bg-olive text-beige py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Select This Month"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Q,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Clear"}),e.jsx("button",{onClick:p,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Close"})]})]})}):null},Ye=({isOpen:D,onClose:p,onConfirm:b,title:h,message:j,type:$})=>D?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background text-olive rounded p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-lexend font-semibold tracking-tighter",children:h}),e.jsx("p",{className:"text-olive mb-6 font-lexend font-light tracking-tight",children:j}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:p,className:"flex-1 bg-[hsl(var(--destructive))] hover:bg-[hsl(var(--destructive)/0.8)] text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"No"}),e.jsx("button",{onClick:b,className:"flex-1 bg-olive hover:bg-olive-light text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"Yes"})]})]})}):null,He=({isOpen:D,onClose:p,onReservationCreated:b,timeSlots:h,systemSettings:j})=>{const{showNotification:$}=fe(),[f,v]=n.useState(new Date().getMonth()),[r,y]=n.useState(new Date().getFullYear()),[i,w]=n.useState(h.length>0?h[0].id:null),[N,R]=n.useState(j.min_guest_size||1),[x,W]=n.useState(null),[E,K]=n.useState(""),[T,_]=n.useState(""),[C,P]=n.useState(""),[A,V]=n.useState(""),[Q,I]=n.useState(""),[c,L]=n.useState([]),[O,Y]=n.useState([]),[u,m]=n.useState([]),[S,g]=n.useState([]),[H,F]=n.useState({}),[U,X]=n.useState(!1),Z=["January","February","March","April","May","June","July","August","September","October","November","December"],le=[new Date().getFullYear(),new Date().getFullYear()+1,new Date().getFullYear()+2],ie=new Date,s=new Date(ie.getTime()+j.max_advance_booking_days*24*60*60*1e3);n.useEffect(()=>{d(),k(),q()},[f,r]);const d=async()=>{try{const a=await(await fetch(`/reservations/fully-booked-dates?month=${f+1}&year=${r}`)).json();m(a.fully_booked_dates||[])}catch(t){console.error("Error fetching fully booked dates:",t),m([])}},k=async()=>{try{const a=await(await fetch(`/reservations/closed-dates?month=${f+1}&year=${r}`)).json();g(a.closed_dates||[])}catch(t){console.error("Error fetching closed dates:",t),g([])}},q=async()=>{try{const a=await(await fetch(`/reservations/special-hours-dates?month=${f+1}&year=${r}`)).json(),o={};a.special_hours_data&&a.special_hours_data.forEach(l=>{o[l.day]={special_start:l.special_start,special_end:l.special_end}}),F(o)}catch(t){console.error("Error fetching special hours dates:",t),F({})}},ee=t=>{const a=new Date(r,f,t);a.setHours(0,0,0,0);const o=new Date;return o.setHours(0,0,0,0),!!(a<o||a>s||S.includes(t))},z=t=>u.includes(t),ge=t=>S.includes(t),ue=t=>H.hasOwnProperty(t),ce=t=>H[t]||null,se=t=>{if(!t)return"";const a=t.toUpperCase();if(a.includes("AM")||a.includes("PM"))return t;const o=t.split(":");if(o.length<2)return t;let l=parseInt(o[0],10);const B=o[1],J=l>=12?"PM":"AM";return l=l%12,l===0&&(l=12),`${l}:${B.padStart(2,"0")} ${J}`},pe=t=>new Date(t).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),be=async t=>{var J;const a=pe(t.reservation_date);let o="Time not specified";if(x){const M=ce(x);if(M&&(i==="special-hours"||!t.time_slot_id))o=`${se(M.special_start)} - ${se(M.special_end)} (Special Hours)`;else if(t.time_slot_id){const G=h.find(_e=>_e.id===t.time_slot_id);G&&(o=G.start_time_formatted&&G.end_time_formatted?`${G.start_time_formatted} - ${G.end_time_formatted}`:`${se(G.start_time)} - ${se(G.end_time)}`)}}const l=`${t.guest_first_name} ${t.guest_last_name}`.trim(),B={to:t.guest_email,guest_name:l,phone:t.guest_phone||"",date_formatted:a,time_range:o,guest_count:t.guest_count};try{await fetch("/api/send-reservation-confirmation",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((J=document.querySelector('meta[name="csrf-token"]'))==null?void 0:J.getAttribute("content"))||""},body:JSON.stringify(B)})}catch{}},ve=async t=>{try{const o=await(await fetch(`/reservations/occupied-time-slots?date=${t}`)).json();L(o.occupied_time_slots||[]),Y(o.disabled_time_slots||[])}catch(a){console.error("Error fetching occupied time slots:",a),L([]),Y([])}},je=t=>{W(t);const a=`${r}-${String(f+1).padStart(2,"0")}-${String(t).padStart(2,"0")}`;if(ve(a),ue(t))w("special-hours");else{const o=h.find(l=>!c.includes(l.id)&&!O.includes(l.id));w((o==null?void 0:o.id)||null)}};n.useEffect(()=>{if(i&&typeof i=="number"&&(c.includes(i)||O.includes(i))){const t=h.find(a=>!c.includes(a.id)&&!O.includes(a.id));w((t==null?void 0:t.id)||null)}},[c,O,i,h]);const ye=()=>{const t=[];if(x){const o=new Date(r,f,x).toLocaleDateString("en-US",{weekday:"short"}),l=Z[f];t.push(`${l} ${x} (${o})`)}if(i)if(i==="special-hours"){const a=ce(x);a&&t.push(`${a.special_start} - ${a.special_end} (Special Hours)`)}else{const a=h.find(o=>o.id===i);a&&t.push(`${a.start_time_formatted} - ${a.end_time_formatted}`)}return t.push(`${N} Guest${N>1?"s":""}`),!x&&!i?"Select date and time":t.join(", ")},de=()=>x&&i&&(i==="special-hours"||!c.includes(i)&&!O.includes(i))&&E.trim()&&T.trim()&&C.trim()&&A.trim()&&C.includes("@")&&C.includes("."),he=(t,a)=>{/^[a-zA-Z\s]*$/.test(t)&&a(t)},we=t=>{P(t)},Ne=t=>{/^[\d\s\-\+]*$/.test(t)&&t.length<=15&&V(t)},Se=async()=>{var t;if(de()){X(!0);try{const a={guest_first_name:E.trim(),guest_last_name:T.trim(),guest_email:C.trim(),guest_phone:A.trim(),special_requests:Q.trim(),reservation_date:`${r}-${String(f+1).padStart(2,"0")}-${String(x).padStart(2,"0")}`,time_slot_id:i==="special-hours"?null:i,guest_count:N,is_special_hours:i==="special-hours"},l=await(await fetch("/admin/api/quick-reservations",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify(a)})).json();if(l.success){$("Reservation created successfully!","success");try{await be(l.reservation??a)}catch{}b&&b(),xe()}else $(l.message||"Failed to create reservation","error")}catch(a){console.error("Error creating reservation:",a),$("An error occurred while creating the reservation","error")}finally{X(!1)}}},xe=()=>{v(new Date().getMonth()),y(new Date().getFullYear()),w(h.length>0?h[0].id:null),R(j.min_guest_size||1),W(null),K(""),_(""),P(""),V(""),I(""),L([]),Y([]),m([]),g([]),F({}),X(!1),p()};return D?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-[#3f411a] rounded shadow-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl text-beige font-lexend font-extralight",children:"QUICK RESERVATION"}),e.jsx("button",{onClick:xe,className:"text-white cursor-pointer text-3xl font-bold hover:text-beige transition-colors",children:"Ã—"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"flex flex-col justify-start h-full",children:e.jsxs("div",{className:"flex flex-col justify-start h-full",children:[e.jsxs("div",{className:"flex space-x-4 mb-10",children:[e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Month"}),e.jsxs(ae,{value:f.toString(),onValueChange:t=>{v(parseInt(t)),W(null)},children:[e.jsx(ne,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(re,{})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white max-h-none overflow-y-visible",children:Z.map((t,a)=>e.jsx(te,{value:a.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-28",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Year"}),e.jsxs(ae,{value:r.toString(),onValueChange:t=>y(parseInt(t)),children:[e.jsx(ne,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(re,{})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white",children:le.map(t=>e.jsx(te,{value:t.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Time"}),e.jsxs(ae,{value:(i==null?void 0:i.toString())||"",onValueChange:t=>{w(t==="special-hours"?"special-hours":parseInt(t))},children:[e.jsx(ne,{className:`bg-transparent border-b border-white text-white w-full font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto text-left ${i==="special-hours"?"py-3 text-xs":"py-2 text-base"}`,children:e.jsx(re,{children:(()=>{if(i==="special-hours")return"Special Hours";if(i&&typeof i=="number"){const t=h.find(a=>a.id===i);return t?`${t.start_time_formatted} - ${t.end_time_formatted}`:""}return""})()})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white",children:(()=>{const t=x?ce(x):null;return t?e.jsxs(te,{value:"special-hours",className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:[t.special_start," - ",t.special_end," (Special Hours)"]}):h.map(a=>{const o=c.includes(a.id),l=O.includes(a.id),B=o||l;return e.jsxs(te,{value:a.id.toString(),className:`bg-[#3f411a] font-extralight font-lexend focus:bg-[#5a5d2a] relative ${B?"cursor-not-allowed":"hover:bg-[#5a5d2a]"} ${o?"!opacity-100":""} ${l?"!opacity-100":""}`,disabled:B,children:[e.jsxs("span",{className:o?"text-[#D4847C]":l?"text-[#5295bb]":"text-white",children:[a.start_time_formatted," - ",a.end_time_formatted]}),o&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-[#D4847C] rounded-full opacity-100"}),l&&!o&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-[#5295bb] rounded-full opacity-100"})]},a.id)})})()})]})]}),e.jsxs("div",{className:"relative w-24",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Guests"}),e.jsxs(ae,{value:N.toString(),onValueChange:t=>R(parseInt(t)),children:[e.jsx(ne,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(re,{children:N})}),e.jsx(oe,{className:"bg-[#3f411a] border-white text-white",children:(()=>{const t=j.min_guest_size||1,a=j.max_guest_size||10,o=[];for(let l=t;l<=a;l++)o.push(l);return o.map(l=>e.jsx(te,{value:l.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:l},l))})()})]})]})]}),e.jsx($e,{selectedMonth:f,selectedYear:r,selectedDate:x,onDateSelect:je,isDateDisabled:ee,isDateFullyBooked:z,isDateClosed:ge,isDateSpecialHours:ue,months:Z,className:"grid grid-cols-7 text-center gap-y-7 text-white text-lg",weekdayClassName:()=>"h-8 flex items-center justify-center font-lexend text-beige font-medium tracking-wide opacity-80",dayClassName:(t,{isDisabled:a,isFullyBooked:o,isSelected:l,isClosed:B,isSpecialHours:J})=>{let M="transition-colors h-8 w-full flex items-center justify-center font-lexend font-light relative";return B?M+=" text-[#D4847C] cursor-not-allowed":o?M+=" text-[#6B7A5E] cursor-not-allowed":l&&J?M+=" text-[#C5A572] font-semibold":l?M+=" text-[#3f411a] font-semibold":J?M+=" text-[#C5A572] hover:text-beige-dark cursor-pointer":a?M+=" text-gray-400 cursor-not-allowed":M+=" text-white hover:text-beige-dark cursor-pointer",M},animatedSelection:!0}),e.jsxs("div",{className:"flex justify-center items-center space-x-6 mt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#6B7A5E]"}),e.jsx("span",{className:"text-white/80 font-light font-lexend text-sm",children:"Fully Booked"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#C5A572]"}),e.jsx("span",{className:"text-white/80 font-light font-lexend text-sm",children:"Special Hours"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#D4847C]"}),e.jsx("span",{className:"text-white/80 font-light font-lexend text-sm",children:"Closed"})]})]})]})}),e.jsxs("div",{className:"flex flex-col justify-between h-full self-stretch w-full max-w-md ml-auto",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-light font-lexend mb-3 text-white/60",children:"When"}),e.jsx("div",{className:"border-b border-white pb-2 text-lg font-extralight font-lexend text-white",children:ye()})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-light font-lexend mb-2 text-white/60",children:"First Name"}),e.jsx("input",{type:"text",value:E,onChange:t=>he(t.target.value,K),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"First name",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-light font-lexend mb-2 text-white/60",children:"Last Name"}),e.jsx("input",{type:"text",value:T,onChange:t=>he(t.target.value,_),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"Last name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-light font-lexend mb-2 text-white/60",children:"Email"}),e.jsx("input",{type:"email",value:C,onChange:t=>we(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-light font-lexend mb-2 text-white/60",children:"Phone Number"}),e.jsx("input",{type:"tel",value:A,onChange:t=>Ne(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"+639543846071",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-light font-lexend mb-2 text-white/60",children:"Special Requests"}),e.jsx("input",{type:"text",value:Q,onChange:t=>I(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"ex. Food Allergies"})]})]})]}),e.jsx("button",{onClick:Se,disabled:!de()||U,className:`block w-full text-center font-light font-lexend py-4 mt-8 text-lg transition duration-200 uppercase ${de()&&!U?"bg-beige-dark active:bg-beige text-[#3f411a] hover:opacity-90 hover:scale-[1.02] active:scale-[0.98] hover:shadow-lg cursor-pointer tracking-wider":"bg-gray-400 text-gray-600 cursor-not-allowed tracking-wider"}`,children:U?"CREATING RESERVATION...":"CREATE RESERVATION"})]})]})]})})}):null},Be=({status:D,onReservationUpdate:p,endpointPrefix:b,timeSlots:h,systemSettings:j})=>{const{showNotification:$}=fe(),[f,v]=n.useState([]),[r,y]=n.useState(null),[i,w]=n.useState(!1),[N,R]=n.useState(""),[x,W]=n.useState("date-asc"),[E,K]=n.useState(()=>new Date().toISOString().split("T")[0]),[T,_]=n.useState(null),[C,P]=n.useState(null),[A,V]=n.useState(!1),[Q,I]=n.useState(!1),[c,L]=n.useState(null),[O,Y]=n.useState(!1);n.useEffect(()=>{w(!0),fetch(`${b||"/admin"}/api/reservations?status=${D}`).then(s=>s.json()).then(s=>{let d=s.reservations||[];D==="all"&&(d=d.filter(k=>k.status!=="pending")),v(d),w(!1)})},[D,b]);const u=n.useCallback(s=>{y(r===s?null:s)},[r]),m=n.useMemo(()=>f.filter(s=>{const d=s.guest_first_name.toLowerCase().includes(N.toLowerCase())||s.guest_last_name.toLowerCase().includes(N.toLowerCase())||s.email.toLowerCase().includes(N.toLowerCase())||s.phone.toLowerCase().includes(N.toLowerCase());let k=!0;if(E)k=Me(s.reservation_date)===E;else if(T&&C){const q=new Date(s.reservation_date),ee=q.toLocaleString("default",{month:"long"}),z=q.getFullYear();k=ee===T&&z===C}return d&&k}),[f,N,E,T,C]),S=n.useMemo(()=>[...m].sort((s,d)=>{switch(x){case"firstName-asc":return s.guest_first_name.localeCompare(d.guest_first_name);case"firstName-desc":return d.guest_first_name.localeCompare(s.guest_first_name);case"lastName-asc":return s.guest_last_name.localeCompare(d.guest_last_name);case"lastName-desc":return d.guest_last_name.localeCompare(s.guest_last_name);case"timeSlot-am-pm":return me(s.time_slot||"",d.time_slot||"");case"timeSlot-pm-am":return me(d.time_slot||"",s.time_slot||"");case"guest-asc":return s.guest_count-d.guest_count;case"guest-desc":return d.guest_count-s.guest_count;case"date-asc":return s.reservation_date.localeCompare(d.reservation_date);case"date-desc":return d.reservation_date.localeCompare(s.reservation_date);default:return 0}}),[m,x]),g=n.useCallback((s,d,k)=>{L({type:"complete",reservationId:s,reservationName:`${d} ${k}`}),I(!0)},[]),H=n.useCallback((s,d,k)=>{L({type:"cancel",reservationId:s,reservationName:`${d} ${k}`}),I(!0)},[]),F=n.useCallback(async()=>{var s;if(c)try{const d=c.type==="complete"?`${b||"/admin"}/api/reservations/${c.reservationId}/complete`:`${b||"/admin"}/api/reservations/${c.reservationId}/cancel`,q=await(await fetch(d,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}})).json();q.success?(v(ee=>ee.map(z=>z.id===c.reservationId?{...z,status:c.type==="complete"?"completed":"cancelled"}:z)),$(`Reservation ${c.type==="complete"?"completed":"cancelled"} successfully!`,"success"),p&&p()):$(`Failed to ${c.type} reservation: ${q.message}`,"error")}catch{$(`Failed to ${c.type} reservation. Please try again.`,"error")}finally{I(!1),L(null)}},[c,b,p,$]),U=n.useCallback(()=>{I(!1),L(null)},[]),X=n.useCallback(s=>{K(s),_(null),P(null)},[]),Z=n.useCallback((s,d)=>{_(s),P(d),K(null)},[]),le=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ie=()=>E?le(E):T&&C?`${T} ${C}`:"Date";return e.jsxs("div",{className:"bg-white border border-primary-light h-[520px] shadow p-6 flex flex-col",children:[e.jsxs("div",{className:"flex gap-4 mb-2",children:[e.jsx(Ee,{value:N,onChange:s=>R(s.target.value),placeholder:"Search by guest name, email, or number...",className:"basis-[35%]"}),e.jsx(Te,{onClick:()=>V(!0),label:ie(),className:"basis-[15%]"}),e.jsx(Re,{value:x,onChange:W,options:Le,className:"basis-[30%]"}),e.jsxs("button",{onClick:()=>Y(!0),className:"basis-[20%] flex items-center justify-center gap-3 h-10 border-primary-light border bg-primary-light text-olive font-lexend font-light px-2 py-1 transition-all duration-300 hover:scale-[1.02] focus:ring-1 focus:ring-olive focus:outline-none",children:[e.jsx(Fe,{size:18})," New Reservation"]})]}),i?e.jsx("div",{className:"text-center py-8 font-lexend font-light text-gray-500",children:"Loading..."}):S.length===0?e.jsx("div",{className:"text-center py-8 font-lexend text-gray-500",children:"No reservations found."}):e.jsx("div",{className:"w-full flex-1 min-h-0 overflow-y-auto",children:e.jsx(Oe,{children:e.jsxs("table",{className:"w-full text-left font-lexend table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"170px"}}),e.jsx("col",{style:{width:"90px"}}),e.jsx("col",{style:{width:"105px"}}),e.jsx("col",{style:{width:"80px"}}),e.jsx("col",{style:{width:"70px"}}),e.jsx("col",{style:{width:"95px"}}),e.jsx("col",{style:{width:"95px"}})]}),e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-white sticky top-0 z-0",children:[e.jsx("th",{className:"py-3 px-5 font-semibold tracking-tighter truncate",children:"First Name"}),e.jsx("th",{className:"py-3 px-2 font-semibold tracking-tighter truncate",children:"Last Name"}),e.jsx("th",{className:"py-3 px-2 font-semibold tracking-tighter truncate text-center",children:"Reservation Date"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Time Slot"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Guests"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter text-center truncate",children:"Status"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter text-center truncate",children:"Actions"})]})}),e.jsx("tbody",{children:S.map(s=>e.jsx(Ie,{reservation:s,expanded:r===s.id,onExpand:()=>u(s.id),onComplete:()=>g(s.id,s.guest_first_name,s.guest_last_name),onCancel:()=>H(s.id,s.guest_first_name,s.guest_last_name)},s.id))})]})})}),e.jsx(Ae,{isOpen:A,onClose:()=>V(!1),onDateSelect:X,onMonthSelect:Z,selectedDate:E,selectedMonth:T,selectedYear:C}),e.jsx(Ye,{isOpen:Q,onClose:U,onConfirm:F,title:(c==null?void 0:c.type)==="complete"?"Complete Reservation":"Cancel Reservation",message:`Are you sure you want to ${c==null?void 0:c.type} the reservation for ${c==null?void 0:c.reservationName}?`,type:(c==null?void 0:c.type)||"complete"}),h&&j&&e.jsx(He,{isOpen:O,onClose:()=>Y(!1),onReservationCreated:()=>{w(!0),fetch(`${b||"/admin"}/api/reservations?status=${D}`).then(s=>s.json()).then(s=>{let d=s.reservations||[];D==="all"&&(d=d.filter(k=>k.status!=="pending")),v(d),w(!1)}),p&&p()},timeSlots:h,systemSettings:j})]})},Pe=[{label:`CONFIRMED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"confirmed"},{label:`COMPLETED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"completed"},{label:`CANCELLED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"cancelled"},{label:`ALL
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"all"}],Ze=()=>{const{timeSlots:D,systemSettings:p}=Ce().props,[b,h]=n.useState({confirmed:0,completed:0,cancelled:0,all:0}),[j,$]=n.useState("all"),f=()=>{fetch("/admin/api/reservation-counts").then(r=>r.json()).then(r=>{h({confirmed:r.confirmed||0,completed:r.completed||0,cancelled:r.cancelled||0,all:r.all||0})}).catch(r=>{console.error("Error fetching counts:",r)})};n.useEffect(()=>{f()},[]);const v=()=>{f()};return e.jsxs(De,{children:[e.jsxs("div",{className:"flex flex-col items-center px-12 py-10",children:[e.jsx("p",{className:"text-olive text-7xl font-thin font-lexend text-center",children:"BOOKING"}),e.jsx("div",{className:"w-50 h-[1px] bg-olive mt-6",style:{opacity:.5}})]}),e.jsx("div",{className:"px-12 flex gap-6 mb-8",children:Pe.map((r,y)=>e.jsx("button",{className:`flex-1 border-2 p-8 font-lexend font-light text-xl transition-all duration-300 cursor-pointer hover:scale-[1.03] ${j===r.status?r.activeColor:r.color}`,onClick:()=>$(r.status),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("span",{children:r.label.split(`
`).map((i,w)=>e.jsxs(ke.Fragment,{children:[i,e.jsx("br",{})]},w))}),e.jsx("span",{className:"mt-4 text-4xl font-bold tracking-wide",children:b[r.status]})]})},r.label))}),e.jsxs("div",{className:"px-12",children:[e.jsx("div",{className:"mb-6"}),e.jsx(Be,{status:j,onReservationUpdate:v,timeSlots:D,systemSettings:p})]})]})};export{Ze as default};
