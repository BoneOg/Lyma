import{r as n,j as e,J as N,u as b,S as w}from"./app-ObBU9MiU.js";import{L as y}from"./layout-HplSP8KB.js";function C({expiresAt:t,onExpired:l,onAlmostExpired:r}){const[s,u]=n.useState(0),[c,g]=n.useState(!1),[d,p]=n.useState(!1);n.useEffect(()=>{const i=()=>{const m=new Date().getTime(),f=new Date(t).getTime()-m;if(f<=0){u(0),g(!0),l&&l();return}r&&f<=6e4&&!d&&(p(!0),r()),u(f)};i();const o=setInterval(i,1e3);return()=>clearInterval(o)},[t,l,r]);const j=i=>{const o=Math.floor(i/1e3),m=Math.floor(o/60),h=o%60;return`${m.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},x=()=>s<=12e4?"text-red-500":s<=3e5?"text-yellow-500":s<=6e5?"text-orange-500":"text-[#3f411a]";return c?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 flex items-center justify-center rounded-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24",className:"text-red-500",children:e.jsxs("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5",children:[e.jsx("path",{"stroke-linecap":"round",d:"M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.536 1.464C22 4.93 22 7.286 22 12s0 7.071-1.464 8.536C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.464C2 19.072 2 16.714 2 12"}),e.jsx("path",{"stroke-linecap":"round",d:"M12 6v6l4 2"})]})})}),e.jsx("span",{className:"text-red-500 font-lexend font-medium",children:"Expired"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#f6f5c6] flex items-center justify-center rounded-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24",className:"text-[#3f411a]",children:e.jsxs("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5",children:[e.jsx("path",{"stroke-linecap":"round",d:"M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.536 1.464C22 4.93 22 7.286 22 12s0 7.071-1.464 8.536C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.464C2 19.072 2 16.714 2 12"}),e.jsx("path",{"stroke-linecap":"round",d:"M12 6v6l4 2"})]})})}),e.jsx("span",{className:`font-lexend font-medium ${x()}`,children:j(s)})]})}function E(){const{reservation:t,expiresAt:l}=N().props,[r,s]=n.useState(!1),[u,c]=n.useState(null),{showNotification:g}=b(),[d,p]=n.useState(!1),[j,x]=n.useState(!1),i=a=>new Date(a).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),o=()=>{console.log("Timer expired, redirecting to reservation page...");try{console.log("Attempting router.visit to /reservation?expired=1"),w.visit("/reservation?expired=1")}catch(a){console.error("Router visit failed, using window.location:",a),window.location.href="/reservation?expired=1"}},m=()=>{p(!0)},h=async()=>{x(!0)},f=async()=>{x(!1),s(!0),c(null);try{w.post(`/checkout/${t.id}/confirm`,{},{onSuccess:()=>{},onError:a=>{c(a.message||"Failed to confirm reservation. Please try again."),s(!1)},onFinish:()=>{s(!1)}})}catch(a){console.error("Error confirming reservation:",a),c("An unexpected error occurred. Please check your internet connection."),s(!1)}},v=()=>{x(!1)};return e.jsxs(y,{children:[e.jsx("div",{className:"min-h-screen bg-[#f6f5c6] flex items-center justify-center py-12 px-4",children:e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h1",{className:"text-3xl font-lexend font-medium text-[#3f411a] mb-6 text-center",children:"Confirm Your Reservation"}),e.jsx("div",{className:"mb-6",children:e.jsx(C,{expiresAt:l,onExpired:o,onAlmostExpired:m})}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Guest Name"}),e.jsxs("span",{className:"text-[#3f411a] font-lexend font-medium",children:[t.guest_first_name," ",t.guest_last_name]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Email"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:t.guest_email})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Phone"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:t.guest_phone})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Date"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:i(t.reservation_date)})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Year"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:new Date(t.reservation_date).getFullYear()})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-[#3f411a]/20",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Time"}),e.jsxs("span",{className:"text-[#3f411a] font-lexend font-medium",children:[t.time_slot.start_time," - ",t.time_slot.end_time]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsx("span",{className:"text-[#3f411a]/80 font-lexend font-extralight",children:"Number of Guests"}),e.jsx("span",{className:"text-[#3f411a] font-lexend font-medium",children:t.guest_count})]})]}),e.jsx("button",{onClick:h,disabled:r||d,className:`w-full py-4 font-lexend font-medium text-lg transition-all duration-200 ${r||d?"bg-[#3f411a]/30 text-[#3f411a]/50 cursor-not-allowed":"bg-[#3f411a] text-white hover:bg-[#2a2d12] active:scale-[0.98]"}`,children:d?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-[#3f411a]/50",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Reservation is about to expire. Try booking again soon."]}):r?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Confirming Reservation..."]}):"Confirm Reservation"})]})})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-lexend font-medium text-[#3f411a] mb-2",children:"Confirm Reservation"}),e.jsx("p",{className:"text-[#3f411a]/80 font-lexend font-light mb-6",children:"Is this information correct?"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:v,className:"flex-1 py-2 px-4 bg-gray-200 text-gray-700 rounded-lg font-lexend font-medium hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:f,className:"flex-1 py-2 px-4 bg-[#3f411a] text-white rounded-lg font-lexend font-medium hover:bg-[#2a2d12] transition-colors",children:"Confirm"})]})]})})})]})}export{E as default};
