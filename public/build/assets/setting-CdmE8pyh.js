import{r as i,j as e,N as W}from"./app-CUe_SVv-.js";import{A as ne}from"./layout-DLbAKxyh.js";import{S as R,a as Y,b as J,c as L,d as z}from"./select-DiiOD53c.js";import"./utils-BXIBLmXs.js";const le=({settings:r})=>{const[l,C]=i.useState(!1),[_,f]=i.useState(!1),[h,p]=i.useState(!1),[v,y]=i.useState(""),[m,j]=i.useState("success"),[c,b]=i.useState({max_advance_booking_days:r.max_advance_booking_days,capacity:r.capacity||5,restaurant_email:r.restaurant_email,restaurant_phone:r.restaurant_phone}),M=()=>{l&&b({max_advance_booking_days:r.max_advance_booking_days,capacity:r.capacity||5,restaurant_email:r.restaurant_email,restaurant_phone:r.restaurant_phone}),C(!l)},g=(o,x)=>{if(o==="max_advance_booking_days"||o==="capacity"){const d=x.replace(/[^0-9]/g,"");b(u=>({...u,[o]:parseInt(d)||0}))}else o==="restaurant_phone"?/^[\d\s\-\+\(\)]*$/.test(x)&&b(u=>({...u,[o]:x})):b(d=>({...d,[o]:x}))},T=()=>{f(!0)},N=async()=>{var o;f(!1);try{const x=(o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content");if(!x)throw new Error("CSRF token not found");const d=await fetch("/admin/settings/update",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":x,Accept:"application/json"},body:JSON.stringify(c)});if(!d.ok){const S=await d.text();throw console.error("Server response:",d.status,S),new Error(`Server error: ${d.status} ${d.statusText}`)}const u=await d.json();u.success?(y("Settings updated successfully!"),j("success"),p(!0),C(!1),Object.assign(r,c)):(y(u.message||"Failed to update settings"),j("error"),p(!0))}catch(x){console.error("Error updating settings:",x),y(`An error occurred: ${x instanceof Error?x.message:"Unknown error"}`),j("error"),p(!0)}},$=()=>{f(!1)},w=()=>{p(!1)},A=()=>{b({max_advance_booking_days:r.max_advance_booking_days,capacity:r.capacity||5,restaurant_email:r.restaurant_email,restaurant_phone:r.restaurant_phone})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-olive text-white rounded-4xl shadow-lg p-8 h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold font-lexend",children:"System"}),e.jsx("button",{onClick:M,className:`p-2 rounded-lg transition-all duration-200 font-lexend font-medium ${l?"bg-beige text-olive hover:bg-beige-dark active:scale-95":"bg-olive-light text-white hover:bg-olive-dark active:scale-95 border border-olive-light"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5",children:[e.jsx("path",{"stroke-linecap":"round",d:"M22 10.5V12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12s0-7.071 1.464-8.536C4.93 2 7.286 2 12 2h1.5"}),e.jsx("path",{d:"m16.652 3.455l.649-.649A2.753 2.753 0 0 1 21.194 6.7l-.65.649m-3.892-3.893s.081 1.379 1.298 2.595c1.216 1.217 2.595 1.298 2.595 1.298m-3.893-3.893L10.687 9.42c-.404.404-.606.606-.78.829q-.308.395-.524.848c-.121.255-.211.526-.392 1.068L8.412 13.9m12.133-6.552l-5.965 5.965c-.404.404-.606.606-.829.78a4.6 4.6 0 0 1-.848.524c-.255.121-.526.211-1.068.392l-1.735.579m0 0l-1.123.374a.742.742 0 0 1-.939-.94l.374-1.122m1.688 1.688L8.412 13.9"})]})})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-extralight text-beige-dark font-lexend",children:"Max Booking Days"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",value:c.max_advance_booking_days,onChange:o=>g("max_advance_booking_days",o.target.value),className:`w-full px-3 py-2 border border-olive-light rounded-lg focus:outline-none focus:border-beige bg-olive-light text-white font-lexend ${l?"":"cursor-not-allowed opacity-60"}`,disabled:!l,style:{WebkitAppearance:"none",MozAppearance:"textfield"}})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-extralight text-beige-dark font-lexend",children:"Available Tables"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",value:c.capacity,onChange:o=>g("capacity",o.target.value),className:`w-full px-3 py-2 border border-olive-light rounded-lg focus:outline-none focus:border-beige bg-olive-light text-white font-lexend ${l?"":"cursor-not-allowed opacity-60"}`,disabled:!l,style:{WebkitAppearance:"none",MozAppearance:"textfield"}})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-extralight text-beige-dark font-lexend",children:"Restaurant Email"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"email",value:c.restaurant_email,onChange:o=>g("restaurant_email",o.target.value),className:`w-full px-3 py-2 border border-olive-light rounded-lg focus:outline-none focus:border-beige bg-olive-light text-white font-lexend ${l?"":"cursor-not-allowed opacity-60"}`,disabled:!l})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-extralight text-beige-dark font-lexend",children:"Restaurant Phone"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",value:c.restaurant_phone,onChange:o=>g("restaurant_phone",o.target.value),className:`w-full px-3 py-2 border border-olive-light rounded-lg focus:outline-none focus:border-beige bg-olive-light text-white font-lexend ${l?"":"cursor-not-allowed opacity-60"}`,disabled:!l})})]})]}),e.jsxs("div",{className:"flex flex-row gap-3 pt-4",children:[e.jsx("button",{onClick:A,className:"w-1/2 px-6 py-2 bg-beige text-olive rounded-lg font-lexend font-medium hover:bg-beige-dark hover:text-olive-dark transition-colors",children:"Reset"}),e.jsx("button",{onClick:T,className:"w-1/2 px-6 py-2 bg-beige text-olive rounded-lg font-lexend font-medium hover:bg-beige-dark hover:text-olive-dark transition-colors",children:"Save Changes"})]})]})]}),_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-olive text-white rounded-2xl shadow-lg max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-beige-dark rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-olive",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-lexend font-medium text-beige mb-2",children:"Confirm Changes"}),e.jsx("p",{className:"text-beige/80 font-lexend font-light mb-6",children:"Are you sure you want to save these changes to the system settings?"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:$,className:"flex-1 py-2 px-4 bg-beige text-olive rounded-lg font-lexend font-medium hover:bg-beige-dark hover:text-olive-dark transition-colors",children:"Cancel"}),e.jsx("button",{onClick:N,className:"flex-1 py-2 px-4 bg-beige text-olive rounded-lg font-lexend font-medium hover:bg-beige-dark hover:text-olive-dark transition-colors",children:"Save Changes"})]})]})})}),h&&e.jsx(W,{message:v,type:m,onClose:w})]})},oe=({settings:r})=>{const l=new Date,C=new Date(l.getFullYear(),l.getMonth(),l.getDate()),_=new Date(l.getFullYear(),l.getMonth(),l.getDate()+r.max_advance_booking_days),f=["January","February","March","April","May","June","July","August","September","October","November","December"],[h,p]=i.useState(f[l.getMonth()]),[v,y]=i.useState(l.getFullYear()),[m,j]=i.useState("All Time"),[c,b]=i.useState(null),[M,g]=i.useState(!1),[T,N]=i.useState(!1),[$,w]=i.useState(!1),[A,o]=i.useState(""),[x,d]=i.useState("success"),[u,S]=i.useState(new Set),[E,k]=i.useState(new Map);i.useEffect(()=>{const t=localStorage.getItem("disabledDates"),a=localStorage.getItem("disabledTimeSlots");if(t&&S(new Set(JSON.parse(t))),a){const s=JSON.parse(a),n=new Map;Object.keys(s).forEach(D=>{n.set(D,new Set(s[D]))}),k(n)}},[]),i.useEffect(()=>{localStorage.setItem("disabledDates",JSON.stringify([...u]));const t={};E.forEach((a,s)=>{t[s]=[...a]}),localStorage.setItem("disabledTimeSlots",JSON.stringify(t))},[u,E]);const K=[{id:"all",time:"all",formatted:"All Time"},{id:1,time:"11:00",formatted:"11:00 AM"},{id:2,time:"13:30",formatted:"1:30 PM"},{id:3,time:"16:00",formatted:"4:00 PM"},{id:4,time:"18:30",formatted:"6:30 PM"},{id:5,time:"21:00",formatted:"9:00 PM"}],P=(t,a)=>{const s=f.indexOf(t);return new Date(a,s+1,0).getDate()},V=(t,a)=>{const s=f.indexOf(t);return new Date(a,s,1).getDay()},B=t=>{const a=f.indexOf(h),s=new Date(v,a,t);return s<C||s>_},U=t=>{const a=`${h}-${t}`;return u.has(a)},q=(t,a)=>{const s=`${h}-${t}`,n=E.get(s);return n?n.has(a):!1},F=t=>`${h}-${t}`,G=t=>{b(c===t?null:t)},O=()=>{if(c){const t=new Date(l.getFullYear(),f.indexOf(h),c),s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()];return`${h} ${c} (${s}), ${m}`}return`${h} 27 (Friday), ${m}`},H=()=>{g(!0)},X=()=>{N(!0)},Q=()=>{if(c){const t=F(c);m==="All Time"?(S(a=>{const s=new Set(a);return s.delete(t),s}),k(a=>{const s=new Map(a);return s.delete(t),s})):k(a=>{const s=new Map(a),n=s.get(t);return n&&(n.delete(m),n.size===0&&s.delete(t)),s}),o(`${m==="All Time"?"Date":"Time slot"} enabled successfully!`),d("success"),w(!0)}g(!1)},Z=()=>{if(c){const t=F(c);m==="All Time"?(S(a=>new Set([...a,t])),k(a=>{const s=new Map(a);return s.delete(t),s})):k(a=>{const s=new Map(a),n=s.get(t)||new Set;return n.add(m),s.set(t,n),s}),o(`${m==="All Time"?"Date":"Time slot"} disabled successfully!`),d("success"),w(!0)}N(!1)},I=()=>{g(!1),N(!1)},ee=()=>{w(!1)},te=()=>{const t=P(h,v),a=V(h,v),s=[];for(let n=0;n<a;n++)s.push(e.jsx("div",{className:"h-8"},`empty-${n}`));for(let n=1;n<=t;n++){const D=B(n),se=U(n),ae=c===n;s.push(e.jsx("div",{onClick:()=>G(n),className:`cursor-pointer transition-colors h-8 flex items-center justify-center ${D?"text-gray-500 cursor-not-allowed":se?"text-red-500 line-through cursor-pointer":ae?"bg-[#f6f5c6] text-[#3f411a] rounded-lg px-2":"text-white hover:text-[#f6f5c6]"}`,children:n},n))}return s};return e.jsxs("div",{className:"bg-[#3f411a] text-white rounded-4xl p-6 shadow-lg h-full flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-2xl font-semibold font-lexend",children:"Calendar"}),e.jsx("div",{className:"flex gap-2 items-center",children:Array.from({length:3},(t,a)=>l.getFullYear()+a).map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-3 py-1 rounded font-lexend font-medium shadow transition
                  ${t===v?"bg-[#525a1f] text-[#fcfcef] border-2 border-[#3f411a] font-bold":"bg-[#f6f5c6] text-[#3f411a] hover:bg-[#e8e6b3]"}`,style:{minWidth:56},children:t},t))})]}),e.jsxs("div",{className:"mt-7",children:[e.jsxs("div",{className:"grid grid-cols-16 gap-4 mb-4 mt-0",children:[e.jsxs("div",{className:"col-span-4",children:[e.jsx("label",{className:"block text-sm text-beige-dark font-extralight  font-lexend",children:"Month"}),e.jsxs(R,{value:h,onValueChange:p,children:[e.jsx(Y,{className:"bg-olive-light border-olive-light font-extralight font-lexend",children:e.jsx(J,{})}),e.jsx(L,{className:"bg-olive-dark border-olive-light text-white max-h-none",children:f.map(t=>e.jsx(z,{value:t,className:"text-white hover:bg-[#f6f5c6] hover:text-[#3f411a] transition-colors duration-200 cursor-pointer font-lexend font-extralight",children:t},t))})]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-sm text-beige-dark font-extralight font-lexend",children:"Time"}),e.jsxs(R,{value:m,onValueChange:j,children:[e.jsx(Y,{className:"bg-olive-light border-olive-light text-white font-extralight font-lexend",children:e.jsx(J,{})}),e.jsx(L,{className:"bg-olive-dark border-olive-light text-white max-h-none",children:K.map(t=>{const a=c?q(c,t.formatted):!1;return e.jsx(z,{value:t.formatted,className:`transition-colors duration-200 cursor-pointer font-lexend font-extralight ${a?"text-red-500 line-through":"text-white hover:bg-[#f6f5c6] hover:text-[#3f411a]"}`,children:t.formatted},t.id)})})]})]}),e.jsxs("div",{className:"col-span-9",children:[e.jsx("label",{className:"block text-sm text-beige-dark font-extralight font-lexend",children:"When"}),e.jsx("div",{className:"text-white p-3 bg-olive-light border border-olive-light rounded-md h-10 flex items-center font-lexend font-extralight text-sm",children:O()})]})]}),e.jsxs("div",{className:"grid grid-cols-7 text-center gap-y-6 text-[#f6f5c6] mb-6",children:[["SU","MO","TU","WE","TH","FR","SA"].map(t=>e.jsx("div",{children:t},t)),te()]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3]/80 text-[#3f411a] py-3 px-4 rounded-md transition-colors font-lexend",onClick:H,children:"Enable"}),e.jsx("button",{type:"button",className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3]/80 text-[#3f411a] py-3 px-4 rounded-md transition-colors font-lexend",onClick:X,children:"Disable"})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#3f411a] text-white rounded-2xl p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-extralight font-lexend",children:"Confirm Enable"}),e.jsx("p",{className:"text-[#f6f5c6] mb-6 font-extralight font-lexend",children:"Are you sure you want to enable this time slot?"}),e.jsx("p",{className:"text-white mb-6 font-extralight font-lexend",children:O()}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:I,className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3]/80 text-[#3f411a] py-3 px-4 rounded-md font-extralight transition-colors font-lexend",children:"No"}),e.jsx("button",{onClick:Q,className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3]/80 text-[#3f411a] py-3 px-4 rounded-md font-extralight transition-colors font-lexend",children:"Yes"})]})]})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#3f411a] text-white rounded-2xl p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-extralight font-lexend",children:"Confirm Disable"}),e.jsx("p",{className:"text-[#f6f5c6] mb-6 font-extralight font-lexend",children:"Are you sure you want to disable this time slot?"}),e.jsx("p",{className:"text-white mb-6 font-extralight font-lexend",children:O()}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:I,className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3]/80 text-[#3f411a] py-3 px-4 rounded-md font-extralight transition-colors font-lexend",children:"No"}),e.jsx("button",{onClick:Z,className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3]/80 text-[#3f411a] py-3 px-4 rounded-md font-extralight transition-colors font-lexend",children:"Yes"})]})]})}),e.jsx(W,{message:A,type:x,isVisible:$,onClose:ee})]})},xe=({settings:r})=>e.jsxs(ne,{children:[e.jsx("p",{className:"text-olive text-4xl font-bold px-12 py-10 font-lexend ",children:"SETTINGS"}),e.jsxs("div",{className:"px-12 grid grid-cols-2 gap-8",children:[e.jsx(oe,{settings:r}),e.jsx(le,{settings:r})]})]});export{xe as default};
