import{r,j as e,u as le,R as se,J as re}from"./app-CUe_SVv-.js";import{A as oe}from"./layout-DLbAKxyh.js";import{S as G,a as V,b as H,c as Q,d as W}from"./select-DiiOD53c.js";import{C as ce}from"./Calendar-BL0YQ4j_.js";import"./utils-BXIBLmXs.js";const ie=({isOpen:x,onClose:u,onDateSelect:m,selectedDate:i,onMonthSelect:p,selectedMonth:j,selectedYear:f})=>{const[d,l]=r.useState(()=>i?new Date(i).toLocaleString("default",{month:"long"}):new Date().toLocaleString("default",{month:"long"})),[o,T]=r.useState(()=>i?new Date(i).getFullYear():new Date().getFullYear()),[w,k]=r.useState(!1),[S,F]=r.useState(!1),y=["January","February","March","April","May","June","July","August","September","October","November","December"],C=(a,g)=>{const v=y.indexOf(a);return new Date(g,v+1,0).getDate()},Y=(a,g)=>{const v=y.indexOf(a);return new Date(g,v,1).getDay()},N=a=>{const g=y.indexOf(d),v=new Date(o,g,a),b=v.getFullYear(),L=String(v.getMonth()+1).padStart(2,"0"),A=String(a).padStart(2,"0");return`${b}-${L}-${A}`},D=a=>{const g=N(a);console.log("Selected date:",g),m(g),u()},_=()=>{m(null),u()},E=()=>{const a=y.indexOf(d);a===0?(l("December"),T(o-1)):l(y[a-1])},B=()=>{const a=y.indexOf(d);a===11?(l("January"),T(o+1)):l(y[a+1])},$=a=>{l(a),k(!1)},O=a=>{T(a),F(!1)},I=()=>{p?p(d,o):m(null),u()},c=()=>{const a=C(d,o),g=Y(d,o),v=[];for(let b=0;b<g;b++)v.push(e.jsx("div",{className:"h-8"},`empty-${b}`));for(let b=1;b<=a;b++){const L=N(b),A=i===L;v.push(e.jsx("div",{onClick:()=>D(b),className:`cursor-pointer transition-colors h-8 flex items-center justify-center rounded-lg ${A?"bg-[#f6f5c6] text-[#3f411a]":"text-[#3f411a] hover:bg-[#f6f5c6] hover:text-[#3f411a]"}`,children:b},b))}return v},M=new Date().getFullYear(),z=Array.from({length:6},(a,g)=>M+g);return x?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg max-w-sm w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-[#3f411a] font-lexend",children:"Select Date"}),e.jsx("button",{onClick:u,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:E,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-[#3f411a]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>k(!w),className:"px-3 py-1 text-lg font-semibold text-[#3f411a] font-lexend hover:bg-gray-100 rounded-lg transition-colors",children:[d,e.jsx("svg",{className:"w-4 h-4 ml-1 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[120px]",children:y.map(a=>e.jsx("button",{onClick:()=>$(a),className:`block w-full text-left px-3 py-2 hover:bg-gray-100 transition-colors font-lexend ${a===d?"bg-[#f6f5c6] text-[#3f411a]":"text-[#3f411a]"}`,children:a},a))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>F(!S),className:"px-3 py-1 text-lg font-semibold text-[#3f411a] font-lexend hover:bg-gray-100 rounded-lg transition-colors",children:[o,e.jsx("svg",{className:"w-4 h-4 ml-1 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[80px]",children:z.map(a=>e.jsx("button",{onClick:()=>O(a),className:`block w-full text-left px-3 py-2 hover:bg-gray-100 transition-colors font-lexend ${a===o?"bg-[#f6f5c6] text-[#3f411a]":"text-[#3f411a]"}`,children:a},a))})]})]}),e.jsx("button",{onClick:B,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-[#3f411a]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:I,className:"w-full bg-[#f6f5c6] hover:bg-[#e8e6b3] text-[#3f411a] py-2 px-4 rounded-lg transition-colors font-lexend text-sm",children:"Select This Month"})}),e.jsxs("div",{className:"grid grid-cols-7 text-center gap-y-2 mb-4",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map(a=>e.jsx("div",{className:"text-sm font-medium text-gray-500 font-lexend",children:a},a)),c()]}),e.jsxs("div",{className:"flex gap-3",children:[i&&e.jsx("button",{onClick:_,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg transition-colors font-lexend",children:"Clear"}),e.jsx("button",{onClick:u,className:"flex-1 bg-[#f6f5c6] hover:bg-[#e8e6b3] text-[#3f411a] py-2 px-4 rounded-lg transition-colors font-lexend",children:"Close"})]})]})}):null},de=({isOpen:x,onClose:u,onConfirm:m,title:i,message:p,type:j})=>x?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#3f411a] text-white rounded-2xl p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-lexend font-extralight",children:i}),e.jsx("p",{className:"text-[#f6f5c6] mb-6 font-lexend font-extralight",children:p}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:u,className:"flex-1 bg-red-200 hover:bg-red-300 text-red-900 border-red-400 border-2 py-3 px-4 rounded-md font-extralight transition-colors font-lexend",children:"No"}),e.jsx("button",{onClick:m,className:"flex-1 bg-green-200 hover:bg-green-300 text-green-900 border-green-400 border-2 py-3 px-4 rounded-md font-extralight transition-colors font-lexend",children:"Yes"})]})]})}):null,xe=({isOpen:x,onClose:u,onReservationCreated:m,timeSlots:i,systemSettings:p})=>{const{showNotification:j}=le(),[f,d]=r.useState(new Date().getMonth()),[l]=r.useState(new Date().getFullYear()),[o,T]=r.useState(i.length>0?i[0].id:null),[w,k]=r.useState(1),[S,F]=r.useState(null),[y,C]=r.useState(""),[Y,N]=r.useState(""),[D,_]=r.useState(""),[E,B]=r.useState("63"),[$,O]=r.useState([]),[I,c]=r.useState([]),[M,z]=r.useState(!1),a=["January","February","March","April","May","June","July","August","September","October","November","December"],g=new Date;new Date(g.getTime()+p.max_advance_booking_days*24*60*60*1e3),r.useEffect(()=>{v()},[f,l]);const v=async()=>{try{const n=await(await fetch(`/reservations/fully-booked-dates?month=${f+1}&year=${l}`)).json();c(n.fully_booked_dates||[])}catch(t){console.error("Error fetching fully booked dates:",t),c([])}},b=t=>{const n=new Date(l,f,t);n.setHours(0,0,0,0);const h=new Date;if(h.setHours(0,0,0,0),n<=h)return!0;const R=new Date(h.getTime()+p.max_advance_booking_days*24*60*60*1e3);return n>R},L=t=>I.includes(t),A=async t=>{try{const h=await(await fetch(`/reservations/occupied-time-slots?date=${t}`)).json();O(h.occupied_time_slots||[])}catch(n){console.error("Error fetching occupied time slots:",n),O([])}},Z=t=>{F(t);const n=`${l}-${String(f+1).padStart(2,"0")}-${String(t).padStart(2,"0")}`;A(n)};r.useEffect(()=>{if(o&&$.includes(o)){const t=i.find(n=>!$.includes(n.id));T((t==null?void 0:t.id)||null)}},[$,o,i]);const K=()=>{const t=[];if(S){const h=new Date(l,f,S).toLocaleDateString("en-US",{weekday:"long"}),R=a[f];t.push(`${R} ${S} (${h})`)}if(o){const n=i.find(h=>h.id===o);n&&t.push(n.start_time_formatted)}return t.push(`${w} Guest${w>1?"s":""}`),!S&&!o?"Select date and time":t.join(", ")},J=()=>S&&o&&!$.includes(o)&&y.trim()&&Y.trim()&&D.trim()&&E.trim()&&D.includes("@")&&D.includes("."),P=(t,n)=>{/^[a-zA-Z\s]*$/.test(t)&&n(t)},U=t=>{_(t)},X=t=>{/^[\d\s\-\+]*$/.test(t)&&t.length<=12&&B(t)},ee=async()=>{var t;if(!J()){j("Please fill in all required fields correctly.","error");return}z(!0);try{const n={guest_first_name:y.trim(),guest_last_name:Y.trim(),guest_email:D.trim(),guest_phone:E.trim(),reservation_date:`${l}-${String(f+1).padStart(2,"0")}-${String(S).padStart(2,"0")}`,time_slot_id:o,guest_count:w},h=await fetch("/admin/api/quick-reservations",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify(n)}),R=await h.json();h.ok&&R.success?(j("Reservation created successfully!","success"),s(),m&&m()):j(R.message||"Failed to create reservation.","error")}catch(n){console.error("Reservation error:",n),j("An error occurred while creating the reservation.","error")}finally{z(!1)}},s=()=>{d(new Date().getMonth()),T(i.length>0?i[0].id:null),k(1),F(null),C(""),N(""),_(""),B("63"),O([]),c([]),z(!1),u()};return x?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-[#3f411a] rounded-4xl shadow-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl text-beige font-lexend font-bold",children:"Quick Reservation"}),e.jsx("button",{onClick:s,className:"text-beige hover:text-white text-2xl font-bold",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"relative w-45",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Month"}),e.jsxs(G,{value:f.toString(),onValueChange:t=>{d(parseInt(t)),F(null)},children:[e.jsx(V,{className:"bg-[#f6f5c6] border-[#3f411a] text-[#3f411a] w-full pr-8 py-2 text-base font-extralight font-lexend rounded-xl",children:e.jsx(H,{})}),e.jsx(Q,{className:"bg-[#f6f5c6] border-[#3f411a] text-[#3f411a]",children:a.map((t,n)=>e.jsx(W,{value:n.toString(),className:"bg-[#f6f5c6] font-extralight font-lexend text-[#3f411a] hover:bg-[#e8e6b3] focus:bg-[#e8e6b3]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Time"}),e.jsxs(G,{value:(o==null?void 0:o.toString())||"",onValueChange:t=>T(parseInt(t)),children:[e.jsx(V,{className:"bg-[#f6f5c6] border-[#3f411a] text-[#3f411a] w-full pr-8 py-2 text-base font-extralight font-lexend rounded-xl",children:e.jsx(H,{})}),e.jsx(Q,{className:"bg-[#f6f5c6] border-[#3f411a] text-[#3f411a]",children:i.map(t=>{const n=$.includes(t.id);return e.jsxs(W,{value:t.id.toString(),className:`bg-[#f6f5c6] font-extralight font-lexend text-[#3f411a] hover:bg-[#e8e6b3] focus:bg-[#e8e6b3] ${n?"text-gray-500":""}`,disabled:n,children:[t.start_time_formatted," ",n?"(Booked)":""]},t.id)})})]})]}),e.jsxs("div",{className:"relative w-30",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Guests"}),e.jsxs(G,{value:w.toString(),onValueChange:t=>k(parseInt(t)),children:[e.jsx(V,{className:"bg-[#f6f5c6] border-[#3f411a] text-[#3f411a] w-full pr-8 py-2 text-base font-extralight font-lexend rounded-xl",children:e.jsx(H,{})}),e.jsx(Q,{className:"bg-[#f6f5c6] border-[#3f411a] text-[#3f411a]",children:[1,2,3,4,5,6,7,8].map(t=>e.jsx(W,{value:t.toString(),className:"bg-[#f6f5c6] font-extralight font-lexend text-[#3f411a] hover:bg-[#e8e6b3] focus:bg-[#e8e6b3]",children:t},t))})]})]})]}),e.jsx(ce,{selectedMonth:f,selectedYear:l,selectedDate:S,onDateSelect:Z,isDateDisabled:b,isDateFullyBooked:L,months:a})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-3 text-beige",children:"Selected Details"}),e.jsx("div",{className:"border-b border-beige pb-2 text-lg font-extralight font-lexend text-beige",children:K()})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"First Name"}),e.jsx("input",{type:"text",value:y,onChange:t=>P(t.target.value,C),className:"w-full bg-[#f6f5c6] border border-[#3f411a] text-[#3f411a] p-3 rounded-xl outline-none text-base font-extralight font-lexend",placeholder:"First name",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Last Name"}),e.jsx("input",{type:"text",value:Y,onChange:t=>P(t.target.value,N),className:"w-full bg-[#f6f5c6] border border-[#3f411a] text-[#3f411a] p-3 rounded-xl outline-none text-base font-extralight font-lexend",placeholder:"Last name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Email"}),e.jsx("input",{type:"email",value:D,onChange:t=>U(t.target.value),className:"w-full bg-[#f6f5c6] border border-[#3f411a] text-[#3f411a] p-3 rounded-xl outline-none text-base font-extralight font-lexend",placeholder:"Enter email",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-beige",children:"Phone Number"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center bg-[#f6f5c6] border border-[#3f411a] p-3 rounded-xl",children:[e.jsx("span",{className:"text-[#3f411a] text-base font-extralight mr-1 select-none",children:"+"}),e.jsx("input",{type:"tel",value:E,onChange:t=>X(t.target.value),className:"flex-1 bg-transparent text-[#3f411a] outline-none text-base font-extralight font-lexend pr-12",placeholder:"63",required:!0}),e.jsxs("span",{className:"text-[#3f411a] text-sm font-extralight font-lexend",children:[E.length,"/12"]})]})})]}),e.jsx("button",{onClick:ee,disabled:!J()||M,className:`block w-full text-center font-extralight font-lexend py-4 mt-8 text-lg transition duration-200 rounded-xl ${J()&&!M?"bg-beige text-[#3f411a] hover:bg-[#e8e6b3] cursor-pointer":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,children:M?"Creating Reservation...":"Create Reservation"})]})]})]})})}):null};function te(x){return x?x.slice(0,10):""}function ne(x){return x.split("T")[0]}function ae(x,u){const m=i=>{const p=i.toLowerCase(),[j,f]=p.split(" "),[d,l]=j.split(":").map(Number);let o=d;return f==="pm"&&d!==12?o=d+12:f==="am"&&d===12&&(o=0),o*60+l};return m(x)-m(u)}const ue={confirmed:"bg-green-200 text-green-900 border-green-400",completed:"bg-blue-200 text-blue-900 border-blue-400",cancelled:"bg-red-200 text-red-900 border-red-400",all:"bg-yellow-100 text-yellow-900 border-yellow-400"},fe=[{value:"firstName-asc",label:"First Name (A-Z)"},{value:"firstName-desc",label:"First Name (Z-A)"},{value:"lastName-asc",label:"Last Name (A-Z)"},{value:"lastName-desc",label:"Last Name (Z-A)"},{value:"timeSlot-am-pm",label:"Time Slot (Morning-Evening)"},{value:"timeSlot-pm-am",label:"Time Slot (Evening-Morning)"},{value:"guest-asc",label:"Guests (Lowest-Highest)"},{value:"guest-desc",label:"Guests (Highest-Lowest)"},{value:"date-asc",label:"Reservation Date (Earliest-Latest)"},{value:"date-desc",label:"Reservation Date (Latest-Earliest)"}];Array.from({length:31},(x,u)=>(u+1).toString());const me=({status:x,onReservationUpdate:u,endpointPrefix:m,timeSlots:i,systemSettings:p})=>{const{showNotification:j}=le(),[f,d]=r.useState([]),[l,o]=r.useState(null),[T,w]=r.useState(!1),[k,S]=r.useState(""),[F,y]=r.useState("date-asc"),[C,Y]=r.useState(null),[N,D]=r.useState(null),[_,E]=r.useState(null),[B,$]=r.useState(!1),[O,I]=r.useState(!1),[c,M]=r.useState(null),[z,a]=r.useState(!1),[g,v]=r.useState(!1);se.useMemo(()=>["All",...Array.from(new Set(f.map(t=>t.reservation_date.slice(0,4)))).sort()],[f]),r.useEffect(()=>{w(!0),fetch(`${m||"/admin"}/api/reservations?status=${x}`).then(s=>s.json()).then(s=>{let t=s.reservations||[];x==="all"&&(t=t.filter(n=>n.status!=="pending")),console.log("Loaded reservations:",t),d(t),w(!1)})},[x,m]);const b=s=>{o(l===s?null:s)};let L=f.filter(s=>{const t=s.guest_first_name.toLowerCase().includes(k.toLowerCase())||s.guest_last_name.toLowerCase().includes(k.toLowerCase())||s.email.toLowerCase().includes(k.toLowerCase())||s.phone.toLowerCase().includes(k.toLowerCase());let n=!0;if(C)n=ne(s.reservation_date)===C;else if(N&&_){const h=new Date(s.reservation_date),R=h.toLocaleString("default",{month:"long"}),q=h.getFullYear();n=R===N&&q===_}return(C||N&&_)&&console.log("Comparing dates:",{selectedDate:C,selectedMonth:N,selectedYear:_,reservationDate:s.reservation_date,normalizedReservationDate:ne(s.reservation_date),reservationMonth:new Date(s.reservation_date).toLocaleString("default",{month:"long"}),reservationYear:new Date(s.reservation_date).getFullYear(),matches:n}),t&&n});L=L.sort((s,t)=>{switch(F){case"firstName-asc":return s.guest_first_name.localeCompare(t.guest_first_name);case"firstName-desc":return t.guest_first_name.localeCompare(s.guest_first_name);case"lastName-asc":return s.guest_last_name.localeCompare(t.guest_last_name);case"lastName-desc":return t.guest_last_name.localeCompare(s.guest_last_name);case"timeSlot-am-pm":return ae(s.time_slot||"",t.time_slot||"");case"timeSlot-pm-am":return ae(t.time_slot||"",s.time_slot||"");case"guest-asc":return s.guest_count-t.guest_count;case"guest-desc":return t.guest_count-s.guest_count;case"date-asc":return s.reservation_date.localeCompare(t.reservation_date);case"date-desc":return t.reservation_date.localeCompare(s.reservation_date);default:return 0}});const A=(s,t,n)=>{M({type:"complete",reservationId:s,reservationName:`${t} ${n}`}),I(!0)},Z=(s,t,n)=>{M({type:"cancel",reservationId:s,reservationName:`${t} ${n}`}),I(!0)},K=async()=>{var s;if(c){a(!0);try{const t=c.type==="complete"?`${m||"/admin"}/api/reservations/${c.reservationId}/complete`:`${m||"/admin"}/api/reservations/${c.reservationId}/cancel`,h=await(await fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}})).json();h.success?(d(R=>R.map(q=>q.id===c.reservationId?{...q,status:c.type==="complete"?"completed":"cancelled"}:q)),j(`Reservation ${c.type==="complete"?"completed":"cancelled"} successfully!`,"success"),u&&u()):j(`Failed to ${c.type} reservation: ${h.message}`,"error")}catch(t){console.error("Error executing action:",t),j(`Failed to ${c.type} reservation. Please try again.`,"error")}finally{a(!1),I(!1),M(null)}}},J=()=>{I(!1),M(null)},P=s=>{Y(s),D(null),E(null)},U=(s,t)=>{D(s),E(t),Y(null)},X=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ee=()=>C?X(C):N&&_?`${N} ${_}`:"Date";return e.jsxs("div",{className:"bg-white rounded-4xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl text-[#3f411a] font-lexend font-bold",children:"Reservations"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto justify-end",children:[e.jsx("button",{onClick:()=>v(!0),className:"rounded-xl bg-[#f6f5c6] text-[#3f411a] font-lexend border-none px-4 py-2 focus:ring-2 focus:ring-yellow-300 hover:bg-[#e8e6b3] transition-colors",title:"Quick Reservation",children:"+"}),e.jsxs(G,{value:F,onValueChange:y,children:[e.jsx(V,{className:"w-100 rounded-xl bg-[#f6f5c6] text-[#3f411a] font-lexend border-none px-4 py-2 focus:ring-2 focus:ring-yellow-300",children:e.jsx(H,{})}),e.jsx(Q,{className:"w-100 bg-[#f6f5c6] py-2 text-[#3f411a] border-[#f6f5c6]",children:fe.map(s=>e.jsx(W,{value:s.value,className:"text-[#3f411a] hover:bg-[#e8e6b3] focus:bg-[#e8e6b3] font-lexend",children:s.label},s.value))})]}),e.jsx("button",{onClick:()=>$(!0),className:"rounded-xl bg-[#f6f5c6] text-[#3f411a] font-lexend border-none px-4 py-2 focus:ring-2 focus:ring-yellow-300 hover:bg-[#e8e6b3] transition-colors",children:ee()}),e.jsx("input",{type:"text",className:"w-68 rounded-xl bg-[#f6f5c6] text-[#3f411a] font-lexend border-none px-4 py-2 focus:ring-2 focus:ring-yellow-300",placeholder:"Search...",value:k,onChange:s=>S(s.target.value)})]})]}),T?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):L.length===0?e.jsx("div",{className:"text-center py-8 font-lexend text-gray-500",children:"No reservations found."}):e.jsxs("table",{className:"w-full text-left font-lexend",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"py-3 px-3 font-regular",children:"First Name"}),e.jsx("th",{className:"py-3 px-6 font-regular",children:"Last Name"}),e.jsx("th",{className:"py-3 px-3 font-regular",children:"Reservation Date"}),e.jsx("th",{className:"py-3 px-1 text-center font-regular",children:"Time Slot"}),e.jsx("th",{className:"py-3 px-3 text-center font-regular",children:"Guests"}),e.jsx("th",{className:"py-3 px-3 text-center font-regular",children:"Status"}),e.jsx("th",{className:"py-3 px-3 text-center font-regular",children:"Action"})]})}),e.jsx("tbody",{children:L.map(s=>e.jsxs(se.Fragment,{children:[e.jsxs("tr",{className:`cursor-pointer hover:bg-yellow-50 transition ${l===s.id?"bg-yellow-50":""}`,onClick:()=>b(s.id),children:[e.jsx("td",{className:"py-6 px-3 font-light",children:s.guest_first_name}),e.jsx("td",{className:"py-6 px-6 font-light",children:s.guest_last_name}),e.jsx("td",{className:"py-6 px-3 font-light",children:te(s.reservation_date)}),e.jsx("td",{className:"py-6 px-1 text-center font-light",children:s.time_slot||"-"}),e.jsx("td",{className:"py-6 px-3 text-center font-light",children:s.guest_count}),e.jsx("td",{className:"py-6 px-3 text-center",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full border text-xs font-extralight capitalize ${ue[s.status]||"bg-gray-200 text-gray-700 border-gray-300"}`,children:s.status})}),e.jsx("td",{className:"py-6 px-3 text-center",children:s.status!=="completed"&&s.status!=="cancelled"&&e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("button",{className:"bg-blue-200 hover:bg-blue-300 text-blue-900 border-blue-400 border px-3 py-1 rounded text-xs font-extralight",onClick:t=>{t.stopPropagation(),A(s.id,s.guest_first_name,s.guest_last_name)},children:"Complete"}),e.jsx("button",{className:"bg-red-200 hover:bg-red-300 text-red-900 border-red-400 border px-3 py-1 rounded text-xs font-extralight",onClick:t=>{t.stopPropagation(),Z(s.id,s.guest_first_name,s.guest_last_name)},children:"Cancel"})]})})]}),l===s.id&&e.jsx("tr",{className:"bg-yellow-50",children:e.jsx("td",{colSpan:7,className:"py-3 px-3",children:e.jsxs("div",{className:"flex flex-col gap-2 text-sm text-[#3f411a] font-light",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Email:"})," ",s.email]}),e.jsxs("div",{children:[e.jsx("b",{children:"Phone:"})," ",s.phone]}),e.jsxs("div",{children:[e.jsx("b",{children:"Created At:"})," ",te(s.created_at)]}),e.jsxs("div",{children:[e.jsx("b",{children:"Updated At:"})," ",te(s.updated_at)]})]})})})]},s.id))})]}),e.jsx(ie,{isOpen:B,onClose:()=>$(!1),onDateSelect:P,onMonthSelect:U,selectedDate:C,selectedMonth:N,selectedYear:_}),e.jsx(de,{isOpen:O,onClose:J,onConfirm:K,title:(c==null?void 0:c.type)==="complete"?"Complete Reservation":"Cancel Reservation",message:`Are you sure you want to ${c==null?void 0:c.type} the reservation for ${c==null?void 0:c.reservationName}?`,type:(c==null?void 0:c.type)||"complete"}),i&&p&&e.jsx(xe,{isOpen:g,onClose:()=>v(!1),onReservationCreated:()=>{w(!0),fetch(`${m||"/admin"}/api/reservations?status=${x}`).then(s=>s.json()).then(s=>{let t=s.reservations||[];x==="all"&&(t=t.filter(n=>n.status!=="pending")),d(t),w(!1)}),u&&u()},timeSlots:i,systemSettings:p})]})},he=[{label:"Confirmed Reservation",color:"bg-green-200 hover:bg-green-300 text-green-900 border-green-400",activeColor:"bg-green-300 text-green-900 border-green-500 ring-4 ring-green-300",status:"confirmed"},{label:"Completed Reservation",color:"bg-blue-200 hover:bg-blue-300 text-blue-900 border-blue-400",activeColor:"bg-blue-300 text-blue-900 border-blue-500 ring-4 ring-blue-300",status:"completed"},{label:"Cancelled Reservation",color:"bg-red-200 hover:bg-red-300 text-red-900 border-red-400",activeColor:"bg-red-300 text-red-900 border-red-500 ring-4 ring-red-300",status:"cancelled"},{label:"All Reservation",color:"bg-yellow-100 hover:bg-yellow-200 text-yellow-900 border-yellow-400",activeColor:"bg-yellow-200 text-yellow-900 border-yellow-500 ring-4 ring-yellow-300",status:"all"}],ye=()=>{const{timeSlots:x,systemSettings:u}=re().props,[m,i]=r.useState({confirmed:0,completed:0,cancelled:0,all:0}),[p,j]=r.useState("all"),f=()=>{fetch("/admin/api/reservation-counts").then(l=>l.json()).then(l=>{i({confirmed:l.confirmed||0,completed:l.completed||0,cancelled:l.cancelled||0,all:l.all||0})}).catch(l=>{console.error("Error fetching counts:",l)})};r.useEffect(()=>{f()},[]);const d=()=>{f()};return e.jsxs(oe,{children:[e.jsx("p",{className:"text-olive text-4xl font-bold px-12 py-10 font-lexend",children:"BOOKING"}),e.jsx("div",{className:"px-12 flex gap-6 mb-8",children:he.map(l=>e.jsx("button",{className:`flex-1 rounded-2xl shadow border-2 p-8 font-lexend font-light text-xl transition-all duration-200 cursor-pointer ${p===l.status?l.activeColor:l.color}`,onClick:()=>j(l.status),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("span",{children:l.label}),e.jsx("span",{className:"mt-4 text-4xl font-bold tracking-wide",children:m[l.status]})]})},l.label))}),e.jsx("div",{className:"px-12",children:e.jsx(me,{status:p,onReservationUpdate:d,timeSlots:x,systemSettings:u})})]})};export{ye as default};
