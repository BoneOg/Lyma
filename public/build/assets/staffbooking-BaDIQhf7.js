import{J as fe,r as a,j as e,t as xe,S as ye,u as me,R as Se}from"./app-DJ4blC9j.js";import{n as Ce,c as he}from"./utils-WuXrF6sg.js";import{S as ke,D as _e,a as De,s as Me,T as $e,R as Le}from"./reservationTable-C0N3ZFnI.js";import{S as ee,a as te,b as se,c as ae,d as X,C as Re}from"./Calendar-CdXtC8b2.js";import{P as Ee}from"./x-CMtLTFRa.js";import"./check-BnU_BktV.js";const Te=()=>{const{url:y}=fe(),[p,g]=a.useState(!1),x=()=>{g(!0)},N=()=>{ye.post("/logout")},C=()=>{g(!1)},f=[{id:"booking",label:"Booking",href:"/staff/booking"}],d=(y.startsWith("/staff/booking"),"booking");return e.jsxs("div",{className:"fixed top-0 left-0 h-screen w-64 bg-olive text-white flex flex-col shadow-xl z-20 border-r border-olive-light",children:[e.jsx("div",{className:"p-6 border-b border-olive-light",children:e.jsx(xe,{href:"/staff/booking",className:"block overflow-hidden",children:e.jsx("img",{src:"/assets/images/lyma.png",alt:"Lyma by Chef Mar",className:"w-full h-16 object-cover object-center",style:{objectPosition:"center",objectFit:"cover",transform:"scale(3)",transformOrigin:"center"}})})}),e.jsx("nav",{className:"flex-1 pb-6",children:f.map(h=>e.jsxs(xe,{href:h.href,className:`w-full flex items-center px-6 py-5 text-left font-lexend font-extralight transition-all duration-200 ease-in-out ${d===h.id?"bg-[#5a5d2a] text-[#f6f5c6]":"text-[#e8e6b3] hover:bg-[#5a5d2a] hover:text-[#f6f5c6]"}`,children:[e.jsx("span",{className:"mr-3 transition-transform duration-200 ease-in-out group-hover:scale-110",children:h.id==="booking"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5",children:[e.jsx("path",{d:"M2 12c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12v2c0 3.771 0 5.657-1.172 6.828S17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.212S2 17.771 2 14z"}),e.jsx("path",{"stroke-linecap":"round",d:"M7 4V2.5M17 4V2.5M2.5 9h19"})]})})}),e.jsx("span",{className:"transition-all duration-200 ease-in-out font-lexend",children:h.label})]},h.id))}),e.jsx("div",{className:"border-t border-[#5a5d2a]",children:e.jsxs("button",{onClick:x,className:"relative flex items-center text-white hover:text-[#f6f5c6] hover:bg-[#5a5d2a] justify-center transition-all duration-200 ease-in-out rounded w-full font-lexend py-5",children:[e.jsx("span",{className:"absolute left-6 transform -scale-x-100 transition-transform duration-200 ease-in-out hover:scale-110",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M13.496 21H6.5c-1.105 0-2-1.151-2-2.571V5.57c0-1.419.895-2.57 2-2.57h7M16 15.5l3.5-3.5L16 8.5m-6.5 3.496h10"})})}),e.jsx("span",{className:"transition-all duration-200 ease-in-out font-lexend font-extralight",children:"Logout"})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background text-olive rounded p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-lexend font-semibold tracking-tighter",children:"Confirm Logout"}),e.jsx("p",{className:"text-olive mb-6 font-lexend font-light tracking-tight",children:"Are you sure you want to logout?"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:C,className:"flex-1 bg-[hsl(var(--destructive))] hover:bg-[hsl(var(--destructive)/0.8)] text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"No"}),e.jsx("button",{onClick:N,className:"flex-1 bg-olive hover:bg-olive-light text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"Yes"})]})]})})]})},Fe=({children:y})=>e.jsxs("div",{className:"min-h-screen bg-beige-light relative",children:[e.jsx("div",{className:"fixed top-0 left-0 h-full z-10",children:e.jsx(Te,{})}),e.jsx("div",{className:"ml-64",children:y})]}),Ie=({isOpen:y,onClose:p,onDateSelect:g,selectedDate:x,onMonthSelect:N,selectedMonth:C,selectedYear:f})=>{const[b,d]=a.useState(()=>x?new Date(x).toLocaleString("default",{month:"long"}):new Date().toLocaleString("default",{month:"long"})),[h,n]=a.useState(()=>x?new Date(x).getFullYear():new Date().getFullYear()),[D,v]=a.useState(!1),[M,j]=a.useState(h),[V,L]=a.useState(!1),[q,R]=a.useState(!1),k=["January","February","March","April","May","June","July","August","September","October","November","December"],_=(o,m)=>{const S=k.indexOf(o);return new Date(m,S+1,0).getDate()},P=(o,m)=>{const S=k.indexOf(o);return new Date(m,S,1).getDay()},O=o=>{const m=k.indexOf(b),S=new Date(h,m,o),w=S.getFullYear(),Y=String(S.getMonth()+1).padStart(2,"0"),I=String(o).padStart(2,"0");return`${w}-${Y}-${I}`},z=o=>{const m=O(o);console.log("Selected date:",m),g(m),p()},J=()=>{g(null),p()},T=()=>{const o=k.indexOf(b);o===0?(d("December"),n(h-1)):d(k[o-1])},u=()=>{const o=k.indexOf(b);o===11?(d("January"),n(h+1)):d(k[o+1])},E=()=>{N?N(b,h):g(null),p()},F=()=>{const o=_(b,h),m=P(b,h),S=[];for(let w=0;w<m;w++)S.push(e.jsx("div",{className:"h-8"},`empty-${w}`));for(let w=1;w<=o;w++){const Y=O(w),I=x===Y;S.push(e.jsx("div",{onClick:()=>z(w),className:`cursor-pointer transition-colors h-8 flex items-center justify-center rounded-lg font-lexend ${I?"bg-olive text-beige":"text-[#3f411a] hover:bg-olive hover:text-beige"}`,children:w},w))}return S},W=new Date().getFullYear();return Array.from({length:6},(o,m)=>W+m),y?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background rounded p-8 shadow-lg max-w-lg w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-[#3f411a] font-lexend",children:"Select Date"}),e.jsx("button",{onClick:p,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:T,className:"p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors","aria-label":"Previous Month",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"relative mx-2 flex-1 flex justify-center",children:[e.jsxs("button",{onClick:()=>{v(!D),j(h)},className:"px-4 py-2 text-lg font-semibold text-[#3f411a] font-lexend rounded hover:bg-gray-300 transition-colors text-center whitespace-nowrap",style:{minWidth:140},children:[b," ",h]}),D&&e.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-3 bg-background border border-gray-400 rounded-lg shadow-lg z-10 min-w-[380px] p-4",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("button",{onClick:()=>j(M-1),className:"absolute left-0 top-1/2 -translate-y-1/2 p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("span",{className:"block text-xl font-semibold text-[#3f411a] font-lexend select-none text-center",children:M}),e.jsx("button",{onClick:()=>j(M+1),className:"absolute right-0 top-1/2 -translate-y-1/2 p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-4",children:k.map(o=>e.jsx("button",{onClick:()=>{d(o),n(M),v(!1)},className:`flex items-center justify-center px-6 py-3 hover:bg-olive hover:text-beige cursor-pointer transition-colors rounded font-lexend text-olive text-sm ${o===b&&M===h?"bg-olive text-beige  font-medium":""}`,children:o},o))}),e.jsx("button",{onClick:()=>v(!1),className:"w-full mt-2 px-3 py-2 text-base text-olive font-lexend bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors cursor-pointer rounded",children:"Close"})]})]}),e.jsx("button",{onClick:u,className:"p-2 rounded hover:bg-olive-light hover:text-beige-light transition-colors","aria-label":"Next Month",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"grid grid-cols-7 text-center gap-y-2 mb-4",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map(o=>e.jsx("div",{className:"text-base font-medium text-gray-500 font-lexend",children:o},o)),F()]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:E,className:"w-full bg-olive-light hover:bg-olive text-beige py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Select This Month"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:J,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Clear Date"}),e.jsx("button",{onClick:p,className:"flex-1 bg-olive hover:bg-olive-dark text-beige py-2 px-4 rounded-lg transition-colors font-lexend text-base",children:"Close"})]})]})}):null},Oe=({isOpen:y,onClose:p,onConfirm:g,action:x,reservationName:N})=>{const C=()=>x==="complete"?"Complete Reservation":"Cancel Reservation",f=()=>x==="complete"?e.jsxs(e.Fragment,{children:["Are you sure you want to ",e.jsx("span",{className:"font-bold text-green-700 ",children:"complete"})," the reservation for ",e.jsx("span",{className:"font-bold ",children:N}),"?"]}):e.jsxs(e.Fragment,{children:["Are you sure you want to ",e.jsx("span",{className:"font-bold text-red-700 ",children:"cancel"})," the reservation for ",e.jsx("span",{className:"font-bold",children:N}),"?"]});return y?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background text-olive rounded p-6 shadow-lg max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl mb-4 font-lexend font-semibold tracking-tighter",children:C()}),e.jsx("p",{className:"text-olive mb-6 font-lexend font-light tracking-tight",children:f()}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:p,className:"flex-1 bg-[hsl(var(--destructive))] hover:bg-[hsl(var(--destructive)/0.8)] text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"No"}),e.jsx("button",{onClick:g,className:"flex-1 bg-olive hover:bg-olive-light text-white border-none py-3 px-4 rounded font-regular transition-colors font-lexend cursor-pointer",children:"Yes"})]})]})}):null},Ye=({status:y,onReservationUpdate:p,endpointPrefix:g,timeSlots:x,systemSettings:N})=>{const{showNotification:C}=me(),[f,b]=a.useState([]),[d,h]=a.useState(null),[n,D]=a.useState(!1),[v,M]=a.useState(""),[j,V]=a.useState("date-asc"),[L,q]=a.useState(()=>new Date().toISOString().split("T")[0]),[R,k]=a.useState(null),[_,P]=a.useState(null),[O,z]=a.useState(!1),[J,T]=a.useState(!1),[u,E]=a.useState(null),[F,W]=a.useState(!1);a.useEffect(()=>{D(!0),fetch(`${g||"/staff"}/api/reservations?status=${y}`).then(s=>s.json()).then(s=>{let i=s.reservations||[];y==="all"&&(i=i.filter($=>$.status!=="pending")),b(i),D(!1)})},[y,g]);const o=a.useCallback(s=>{h(d===s?null:s)},[d]),m=a.useMemo(()=>f.filter(s=>{const i=s.guest_first_name.toLowerCase().includes(v.toLowerCase())||s.guest_last_name.toLowerCase().includes(v.toLowerCase())||s.email.toLowerCase().includes(v.toLowerCase())||s.phone.toLowerCase().includes(v.toLowerCase());let $=!0;if(L)$=Ce(s.reservation_date)===L;else if(R&&_){const B=new Date(s.reservation_date),U=B.toLocaleString("default",{month:"long"}),H=B.getFullYear();$=U===R&&H===_}return i&&$}),[f,v,L,R,_]),S=a.useMemo(()=>[...m].sort((s,i)=>{switch(j){case"firstName-asc":return s.guest_first_name.localeCompare(i.guest_first_name);case"firstName-desc":return i.guest_first_name.localeCompare(s.guest_first_name);case"lastName-asc":return s.guest_last_name.localeCompare(i.guest_last_name);case"lastName-desc":return i.guest_last_name.localeCompare(s.guest_last_name);case"timeSlot-am-pm":return he(s.time_slot||"",i.time_slot||"");case"timeSlot-pm-am":return he(i.time_slot||"",s.time_slot||"");case"guest-asc":return s.guest_count-i.guest_count;case"guest-desc":return i.guest_count-s.guest_count;case"date-asc":return s.reservation_date.localeCompare(i.reservation_date);case"date-desc":return i.reservation_date.localeCompare(s.reservation_date);default:return 0}}),[m,j]),w=a.useCallback((s,i,$)=>{E({type:"complete",reservationId:s,reservationName:`${i} ${$}`}),T(!0)},[]),Y=a.useCallback((s,i,$)=>{E({type:"cancel",reservationId:s,reservationName:`${i} ${$}`}),T(!0)},[]),I=a.useCallback(async()=>{var s;if(u)try{const i=u.type==="complete"?`${g||"/staff"}/api/reservations/${u.reservationId}/complete`:`${g||"/staff"}/api/reservations/${u.reservationId}/cancel`,B=await(await fetch(i,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""}})).json();B.success?(b(U=>U.map(H=>H.id===u.reservationId?{...H,status:u.type==="complete"?"completed":"cancelled"}:H)),C(`Reservation ${u.type==="complete"?"completed":"cancelled"} successfully!`,"success"),p&&p()):C(`Failed to ${u.type} reservation: ${B.message}`,"error")}catch{C(`Failed to ${u.type} reservation. Please try again.`,"error")}finally{T(!1),E(null)}},[u,g,p,C]),G=a.useCallback(()=>{T(!1),E(null)},[]),Q=a.useCallback(s=>{q(s),k(null),P(null)},[]),K=a.useCallback((s,i)=>{k(s),P(i),q(null)},[]),ne=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),re=()=>L?ne(L):R&&_?`${R} ${_}`:"Date";return e.jsxs("div",{className:"bg-white border border-primary-light h-[450px] shadow p-6 flex flex-col",children:[e.jsxs("div",{className:"flex gap-4 mb-2",children:[e.jsx(ke,{value:v,onChange:s=>M(s.target.value),placeholder:"Search by guest name, email, number or details...",className:"flex-1 basis-[55%]"}),e.jsx(_e,{onClick:()=>z(!0),label:re(),className:"basis-[15%]"}),e.jsx(De,{value:j,onChange:V,options:Me,className:"basis-[30%]"})]}),n?e.jsx("div",{className:"text-center py-8 font-lexend font-light text-gray-500",children:"Loading..."}):S.length===0?e.jsx("div",{className:"text-center py-8 font-lexend text-gray-500",children:"No reservations found."}):e.jsx("div",{className:"w-full flex-1 min-h-0 overflow-y-auto",children:e.jsx($e,{children:e.jsxs("table",{className:"w-full text-left font-lexend table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"170px"}}),e.jsx("col",{style:{width:"90px"}}),e.jsx("col",{style:{width:"105px"}}),e.jsx("col",{style:{width:"80px"}}),e.jsx("col",{style:{width:"70px"}}),e.jsx("col",{style:{width:"95px"}}),e.jsx("col",{style:{width:"95px"}})]}),e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-white sticky top-0 z-0",children:[e.jsx("th",{className:"py-3 px-5 font-semibold tracking-tighter truncate",children:"First Name"}),e.jsx("th",{className:"py-3 px-2 font-semibold tracking-tighter truncate",children:"Last Name"}),e.jsx("th",{className:"py-3 px-2 font-semibold tracking-tighter truncate text-center",children:"Reservation Date"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Time Slot"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Guests"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Status"}),e.jsx("th",{className:"py-3 px-1 font-semibold tracking-tighter truncate text-center",children:"Actions"})]})}),e.jsx("tbody",{children:S.map(s=>e.jsx(Le,{reservation:s,expanded:d===s.id,onExpand:()=>o(s.id),onComplete:()=>w(s.id,s.guest_first_name,s.guest_last_name),onCancel:()=>Y(s.id,s.guest_first_name,s.guest_last_name)},s.id))})]})})}),e.jsx(Ie,{isOpen:O,onClose:()=>z(!1),onDateSelect:Q,onMonthSelect:K,selectedDate:L,selectedMonth:R,selectedYear:_}),e.jsx(Oe,{isOpen:J,onClose:G,onConfirm:I,action:(u==null?void 0:u.type)||"complete",reservationName:(u==null?void 0:u.reservationName)||""})]})},Ae=({isOpen:y,onClose:p,onReservationCreated:g,timeSlots:x,systemSettings:N})=>{const{showNotification:C}=me(),[f,b]=a.useState(new Date().getMonth()),[d,h]=a.useState(new Date().getFullYear()),[n,D]=a.useState(x.length>0?x[0].id:null),[v,M]=a.useState(N.min_guest_size||1),[j,V]=a.useState(null),[L,q]=a.useState(""),[R,k]=a.useState(""),[_,P]=a.useState(""),[O,z]=a.useState(""),[J,T]=a.useState(""),[u,E]=a.useState([]),[F,W]=a.useState([]),[o,m]=a.useState([]),[S,w]=a.useState([]),[Y,I]=a.useState({}),[G,Q]=a.useState(!1),K=["January","February","March","April","May","June","July","August","September","October","November","December"],ne=[new Date().getFullYear(),new Date().getFullYear()+1,new Date().getFullYear()+2],re=new Date,s=new Date(re.getTime()+N.max_advance_booking_days*24*60*60*1e3);a.useEffect(()=>{i(),$(),B()},[f,d]);const i=async()=>{try{const r=await(await fetch(`/reservations/fully-booked-dates?month=${f+1}&year=${d}`)).json();m(r.fully_booked_dates||[])}catch(t){console.error("Error fetching fully booked dates:",t),m([])}},$=async()=>{try{const r=await(await fetch(`/reservations/closed-dates?month=${f+1}&year=${d}`)).json();w(r.closed_dates||[])}catch(t){console.error("Error fetching closed dates:",t),w([])}},B=async()=>{try{const r=await(await fetch(`/reservations/special-hours-dates?month=${f+1}&year=${d}`)).json(),l={};r.special_hours_data&&r.special_hours_data.forEach(c=>{l[c.day]={special_start:c.special_start,special_end:c.special_end}}),I(l)}catch(t){console.error("Error fetching special hours dates:",t),I({})}},U=t=>{const r=new Date(d,f,t);r.setHours(0,0,0,0);const l=new Date;return l.setHours(0,0,0,0),!!(r<=l||r>s||S.includes(t))},H=t=>o.includes(t),ge=t=>S.includes(t),le=t=>Y.hasOwnProperty(t),ie=t=>Y[t]||null,pe=async t=>{try{const l=await(await fetch(`/reservations/occupied-time-slots?date=${t}`)).json();E(l.occupied_time_slots||[]),W(l.disabled_time_slots||[])}catch(r){console.error("Error fetching occupied time slots:",r),E([]),W([])}},be=t=>{V(t);const r=`${d}-${String(f+1).padStart(2,"0")}-${String(t).padStart(2,"0")}`;if(pe(r),le(t))D("special-hours");else{const l=x.find(c=>!u.includes(c.id)&&!F.includes(c.id));D((l==null?void 0:l.id)||null)}};a.useEffect(()=>{if(n&&typeof n=="number"&&(u.includes(n)||F.includes(n))){const t=x.find(r=>!u.includes(r.id)&&!F.includes(r.id));D((t==null?void 0:t.id)||null)}},[u,F,n,x]);const ve=()=>{const t=[];if(j){const l=new Date(d,f,j).toLocaleDateString("en-US",{weekday:"long"}),c=K[f];t.push(`${c} ${j} (${l})`)}if(n)if(n==="special-hours"){const r=ie(j);r&&t.push(`${r.special_start} - ${r.special_end} (Special Hours)`)}else{const r=x.find(l=>l.id===n);r&&t.push(r.start_time_formatted)}return t.push(`${v} Guest${v>1?"s":""}`),!j&&!n?"Select date and time":t.join(", ")},oe=()=>j&&n&&(n==="special-hours"||!u.includes(n)&&!F.includes(n))&&L.trim()&&R.trim()&&_.trim()&&O.trim()&&_.includes("@")&&_.includes("."),ce=(t,r)=>{/^[a-zA-Z\s]*$/.test(t)&&r(t)},je=t=>{P(t)},we=t=>{/^[\d\s\-\+]*$/.test(t)&&t.length<=15&&z(t)},Ne=async()=>{var t;if(oe()){Q(!0);try{const r={guest_first_name:L.trim(),guest_last_name:R.trim(),guest_email:_.trim(),guest_phone:O.trim(),special_requests:J.trim(),reservation_date:`${d}-${String(f+1).padStart(2,"0")}-${String(j).padStart(2,"0")}`,time_slot_id:n==="special-hours"?null:n,guest_count:v,is_special_hours:n==="special-hours"},c=await(await fetch("/staff/api/quick-reservations",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify(r)})).json();c.success?(C("Reservation created successfully!","success"),g&&g(),de()):C(c.message||"Failed to create reservation","error")}catch(r){console.error("Error creating reservation:",r),C("An error occurred while creating the reservation","error")}finally{Q(!1)}}},de=()=>{b(new Date().getMonth()),h(new Date().getFullYear()),D(x.length>0?x[0].id:null),M(N.min_guest_size||1),V(null),q(""),k(""),P(""),z(""),T(""),E([]),W([]),m([]),w([]),I({}),Q(!1),p()};return y?e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-[#3f411a] rounded shadow-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl text-beige font-lexend font-extralight",children:"QUICK RESERVATION"}),e.jsx("button",{onClick:de,className:"text-white cursor-pointer text-3xl font-bold hover:text-beige transition-colors",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"flex flex-col justify-start h-full",children:e.jsxs("div",{className:"flex flex-col justify-start h-full",children:[e.jsxs("div",{className:"flex space-x-4 mb-10",children:[e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Month"}),e.jsxs(ee,{value:f.toString(),onValueChange:t=>{b(parseInt(t)),V(null)},children:[e.jsx(te,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(se,{})}),e.jsx(ae,{className:"bg-[#3f411a] border-white text-white max-h-none overflow-y-visible",children:K.map((t,r)=>e.jsx(X,{value:r.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-28",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Year"}),e.jsxs(ee,{value:d.toString(),onValueChange:t=>h(parseInt(t)),children:[e.jsx(te,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(se,{})}),e.jsx(ae,{className:"bg-[#3f411a] border-white text-white",children:ne.map(t=>e.jsx(X,{value:t.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:t},t))})]})]}),e.jsxs("div",{className:"relative w-40",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Time"}),e.jsxs(ee,{value:(n==null?void 0:n.toString())||"",onValueChange:t=>{D(t==="special-hours"?"special-hours":parseInt(t))},children:[e.jsx(te,{className:`bg-transparent border-b border-white text-white w-full font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto text-left ${n==="special-hours"?"py-3 text-xs":"py-2 text-base"}`,children:e.jsx(se,{children:(()=>{if(n==="special-hours")return"Special Hours";if(n&&typeof n=="number"){const t=x.find(r=>r.id===n);return t?t.start_time_formatted:""}return""})()})}),e.jsx(ae,{className:"bg-[#3f411a] border-white text-white",children:(()=>{const t=j?ie(j):null;return t?e.jsxs(X,{value:"special-hours",className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:[t.special_start," - ",t.special_end," (Special Hours)"]}):x.map(r=>{const l=u.includes(r.id),c=F.includes(r.id),Z=l||c;return e.jsxs(X,{value:r.id.toString(),className:`bg-[#3f411a] font-extralight font-lexend focus:bg-[#5a5d2a] relative ${Z?"cursor-not-allowed":"hover:bg-[#5a5d2a]"} ${l?"!opacity-100":""} ${c?"!opacity-100":""}`,disabled:Z,children:[e.jsx("span",{className:l?"text-[#D4847C]":c?"text-[#5295bb]":"text-white",children:r.start_time_formatted}),l&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-[#D4847C] rounded-full opacity-100"}),c&&!l&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-[#5295bb] rounded-full opacity-100"})]},r.id)})})()})]})]}),e.jsxs("div",{className:"relative w-24",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Guests"}),e.jsxs(ee,{value:v.toString(),onValueChange:t=>M(parseInt(t)),children:[e.jsx(te,{className:"bg-transparent border-b border-white text-white w-full pr-8 py-2 text-base font-extralight font-lexend rounded-none border-t-0 border-l-0 border-r-0 focus:ring-0 focus:ring-offset-0 px-0 h-auto",children:e.jsx(se,{children:v})}),e.jsx(ae,{className:"bg-[#3f411a] border-white text-white",children:(()=>{const t=N.min_guest_size||1,r=N.max_guest_size||10,l=[];for(let c=t;c<=r;c++)l.push(c);return l.map(c=>e.jsx(X,{value:c.toString(),className:"bg-[#3f411a] font-extralight font-lexend text-white hover:bg-[#5a5d2a] focus:bg-[#5a5d2a]",children:c},c))})()})]})]})]}),e.jsx(Re,{selectedMonth:f,selectedYear:d,selectedDate:j,onDateSelect:be,isDateDisabled:U,isDateFullyBooked:H,isDateClosed:ge,isDateSpecialHours:le,months:K,className:"grid grid-cols-7 text-center gap-y-7 text-white text-lg",dayClassName:(t,{isDisabled:r,isFullyBooked:l,isSelected:c,isClosed:Z,isSpecialHours:ue})=>{let A="transition-colors w-8 h-8 flex items-center justify-center font-lexend font-extralight relative";return Z?A+=" text-[#5295bb] cursor-not-allowed":l?A+=" text-[#D4847C] cursor-not-allowed":c&&ue?A+=" bg-[#f6f5c6] text-[#C5A572] font-semibold rounded-full cursor-pointer":c?A+=" bg-[#f6f5c6] text-[#3f411a] font-semibold rounded-full cursor-pointer":ue?A+=" text-[#C5A572] hover:text-beige-dark cursor-pointer":r?A+=" text-gray-400 cursor-not-allowed":A+=" text-white hover:text-beige-dark cursor-pointer",A}}),e.jsxs("div",{className:"flex justify-center items-center space-x-6 mt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#D4847C]"}),e.jsx("span",{className:"text-white font-extralight font-lexend text-sm",children:"Fully Booked"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#C5A572]"}),e.jsx("span",{className:"text-white font-extralight font-lexend text-sm",children:"Special Hours"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#5295bb]"}),e.jsx("span",{className:"text-white font-extralight font-lexend text-sm",children:"Closed"})]})]})]})}),e.jsxs("div",{className:"flex flex-col justify-between h-full self-stretch w-full max-w-md ml-auto",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-3 text-white",children:"When"}),e.jsx("div",{className:"border-b border-white pb-2 text-lg font-extralight font-lexend text-white",children:ve()})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"First Name"}),e.jsx("input",{type:"text",value:L,onChange:t=>ce(t.target.value,q),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"First name",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Last Name"}),e.jsx("input",{type:"text",value:R,onChange:t=>ce(t.target.value,k),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"Last name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Email"}),e.jsx("input",{type:"email",value:_,onChange:t=>je(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Phone Number"}),e.jsx("input",{type:"tel",value:O,onChange:t=>we(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"+1 234 567 8901",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-base font-extralight font-lexend mb-2 text-white",children:"Special Requests"}),e.jsx("input",{type:"text",value:J,onChange:t=>T(t.target.value),className:"w-full bg-transparent border-b border-white text-white pb-2 outline-none text-base font-extralight font-lexend",placeholder:"ex. Food Allergies"})]})]})]}),e.jsx("button",{onClick:Ne,disabled:!oe()||G,className:`block w-full text-center font-extralight font-lexend py-4 mt-8 text-lg transition duration-200 ${oe()&&!G?"bg-white text-[#3f411a] hover:bg-[#f6f5c6] cursor-pointer":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,children:G?"Creating Reservation...":"Create Reservation"})]})]})]})})}):null},Pe=[{label:`CONFIRMED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"confirmed"},{label:`COMPLETED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"completed"},{label:`CANCELLED
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"cancelled"},{label:`ALL
RESERVATION`,color:"border-primary-light bg-primary-light text-primary",activeColor:"border-olive bg-olive text-white ring-2 ring-primary ring-offset-2",status:"all"}],We=()=>{const{timeSlots:y,systemSettings:p}=fe().props,[g,x]=a.useState({confirmed:0,completed:0,cancelled:0,all:0}),[N,C]=a.useState("all"),[f,b]=a.useState(!1),d=()=>{fetch("/staff/api/reservation-counts").then(n=>n.json()).then(n=>{x({confirmed:n.confirmed||0,completed:n.completed||0,cancelled:n.cancelled||0,all:n.all||0})}).catch(n=>{console.error("Error fetching counts:",n)})};a.useEffect(()=>{d()},[]);const h=()=>{d()};return e.jsxs(Fe,{children:[e.jsxs("div",{className:"flex flex-col items-center px-12 py-10",children:[e.jsx("p",{className:"text-olive text-7xl font-thin font-lexend text-center",children:"BOOKING"}),e.jsx("div",{className:"w-50 h-[1px] bg-olive mt-6",style:{opacity:.5}})]}),e.jsx("div",{className:"px-12 flex gap-6 mb-8",children:Pe.map((n,D)=>e.jsx("button",{className:`flex-1 border-2 p-8 font-lexend font-light text-xl transition-all duration-300 cursor-pointer shadow-card hover:scale-[1.03] ${N===n.status?n.activeColor:n.color}`,onClick:()=>C(n.status),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("span",{children:n.label.split(`
`).map((v,M)=>e.jsxs(Se.Fragment,{children:[v,e.jsx("br",{})]},M))}),e.jsx("span",{className:"mt-4 text-4xl font-bold tracking-wide",children:g[n.status]})]})},n.label))}),e.jsxs("div",{className:"px-12",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl text-[#3f411a] font-lexend font-light",children:"All Reservations"}),e.jsxs("button",{onClick:()=>b(!0),className:"bg-[#3c4119] text-sm text-white font-lexend font-light border-none px-6 py-4 hover:bg-[#525a1f] transition-colors flex items-center gap-2",children:[e.jsx(Ee,{size:18})," New Reservation"]})]}),e.jsx(Ye,{status:N,onReservationUpdate:h,endpointPrefix:"/staff",timeSlots:y,systemSettings:p}),e.jsx(Ae,{isOpen:f,onClose:()=>b(!1),onReservationCreated:h,timeSlots:y,systemSettings:p})]})]})};export{We as default};
